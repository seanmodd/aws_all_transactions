{
  "name" : "all_transactions",
  "jobMode" : "VISUAL",
  "description" : "",
  "role" : "arn:aws:iam::001262071246:role/vSean-GlueDB-CDC",
  "executionProperty" : {
    "maxConcurrentRuns" : 1
  },
  "command" : {
    "name" : "glueetl",
    "scriptLocation" : "s3://aws-glue-assets-001262071246-us-east-1/scripts/all_transactions.py",
    "pythonVersion" : "3"
  },
  "defaultArguments" : {
    "--enable-metrics" : "true",
    "--enable-spark-ui" : "true",
    "--extra-py-files" : "s3://aws-glue-studio-transforms-510798373988-prod-us-east-1/gs_common.py,s3://aws-glue-studio-transforms-510798373988-prod-us-east-1/gs_derived.py",
    "--spark-event-logs-path" : "s3://aws-glue-assets-001262071246-us-east-1/sparkHistoryLogs/",
    "--enable-job-insights" : "true",
    "--enable-observability-metrics" : "true",
    "--enable-glue-datacatalog" : "true",
    "--job-bookmark-option" : "job-bookmark-disable",
    "--job-language" : "python",
    "--TempDir" : "s3://aws-glue-assets-001262071246-us-east-1/temporary/"
  },
  "maxRetries" : 0,
  "allocatedCapacity" : 10,
  "timeout" : 480,
  "maxCapacity" : 10.0,
  "glueVersion" : "5.0",
  "numberOfWorkers" : 10,
  "workerType" : "G.1X",
  "executionClass" : "STANDARD",
  "codeGenConfigurationNodes" : "{\"node-1745434668615\":{\"CustomCode\":{\"ClassName\":\"MyTransform\",\"Code\":\"\\nfrom awsglue.dynamicframe import DynamicFrame\\nfrom pyspark.sql import functions as F\\n\\ndf = dfc.select(list(dfc.keys())[0]).toDF()\\n\\ndf = df.withColumn(\\\"inserted_date_original\\\", F.to_timestamp(\\\"inserted_date\\\"))\\n\\ndf = df.withColumn(\\\"order_name\\\", F.regexp_replace(F.col(\\\"order_name\\\"), \\\"RD San Jose - \\\", \\\"\\\"))\\ndf = df.withColumn(\\\"order_name\\\", F.when(F.col(\\\"order_name\\\").isNull(), \\\"no data\\\").otherwise(F.col(\\\"order_name\\\")))\\ndf = df.withColumn(\\\"order_name\\\", F.regexp_replace(F.col(\\\"order_name\\\"), \\\"RD Oakland - \\\", \\\"\\\"))\\ndf = df.withColumn(\\\"pickup_date\\\", F.when(F.col(\\\"pickup_date\\\") == \\\"Urgent\\\", None).otherwise(F.col(\\\"pickup_date\\\")))\\ndf = df.withColumn(\\n    \\\"inserted_date\\\",\\n    F.when(\\n        (F.col(\\\"order_id\\\") > 75000) &\\n        (F.col(\\\"delivery_date\\\").isNotNull()) &\\n        (~F.lower(F.col(\\\"order_name\\\")).contains(\\\"restaurant depot shopping\\\")),\\n        F.col(\\\"delivery_date\\\")\\n    ).otherwise(F.col(\\\"inserted_date\\\"))\\n)\\n\\ndf = df.withColumn(\\\"pickup_date\\\", F.col(\\\"pickup_date\\\").cast(\\\"timestamp\\\"))\\ndf = df.withColumn(\\\"order_name\\\", F.col(\\\"order_name\\\").cast(\\\"string\\\"))\\ndf = df.withColumn(\\\"inserted_date\\\", F.col(\\\"inserted_date\\\").cast(\\\"timestamp\\\"))\\n\\ndf = df.withColumn(\\\"order_name\\\", F.regexp_replace(F.col(\\\"order_name\\\"), \\\"Januray\\\", \\\"January\\\"))\\ndf = df.withColumn(\\\"order_name\\\", F.regexp_replace(F.col(\\\"order_name\\\"), \\\"Decemeber\\\", \\\"December\\\"))\\ndf = df.withColumn(\\\"order_name\\\", F.regexp_replace(F.col(\\\"order_name\\\"), \\\"September -\\\", \\\"September \\\"))\\ndf = df.withColumn(\\\"order_name\\\", F.regexp_replace(\\n    F.col(\\\"order_name\\\"),\\n    \\\"September 22 - Restaurant Depot Delivery Order3000018798 Cancelled order 09/21\\\",\\n    \\\"September 22 - Restaurant Depot Delivery Order #3000018798\\\"\\n))\\ndf = df.withColumn(\\\"order_name\\\", F.regexp_replace(F.col(\\\"order_name\\\"), \\\"Order # - 0\\\", \\\"Order #0\\\"))\\ndf = df.withColumn(\\\"order_name\\\", F.regexp_replace(F.col(\\\"order_name\\\"), \\\"Restaurant Click Collect\\\", \\\"- Restaurant Click Collect\\\"))\\n\\ndf = df.withColumn(\\n    \\\"ModifiedDate\\\",\\n    F.when(F.col(\\\"order_id\\\").isin(170453, 167216), F.col(\\\"inserted_date\\\"))\\n    .when(F.col(\\\"order_id\\\") > 300000, F.col(\\\"inserted_date\\\"))\\n    .when(F.col(\\\"order_name\\\").isNull(), F.col(\\\"inserted_date\\\"))\\n    .when(\\n        (F.col(\\\"order_name\\\").contains(\\\"Click Collect\\\")) & (F.col(\\\"order_id\\\") <= 3054),\\n        F.concat(F.lit(\\\"2021 \\\"), F.split(F.col(\\\"order_name\\\"), \\\"-\\\").getItem(0))\\n    )\\n    .when(\\n        (F.col(\\\"order_name\\\").contains(\\\"-\\\")) &\\n        (F.col(\\\"order_name\\\").contains(\\\"January\\\")) &\\n        (F.col(\\\"order_id\\\") > 50000) & (F.col(\\\"order_id\\\") < 80000),\\n        F.concat(F.lit(\\\"2021 \\\"), F.split(F.col(\\\"order_name\\\"), \\\"-\\\").getItem(0))\\n    )\\n    .when(\\n        (F.col(\\\"order_name\\\").contains(\\\"-\\\")) &\\n        (F.col(\\\"order_name\\\").contains(\\\"December\\\")) &\\n        (F.col(\\\"order_id\\\") > 45000) & (F.col(\\\"order_id\\\") < 60000),\\n        F.concat(F.lit(\\\"2020 \\\"), F.split(F.col(\\\"order_name\\\"), \\\"-\\\").getItem(0))\\n    )\\n    .when(\\n        (F.col(\\\"order_id\\\") > 100000) & (F.col(\\\"order_id\\\") <= 100044),\\n        F.when(F.col(\\\"pickup_date\\\").isNull(), F.col(\\\"inserted_date\\\")).otherwise(F.col(\\\"pickup_date\\\"))\\n    )\\n    .when(\\n        (F.col(\\\"order_name\\\").contains(\\\"-\\\")) &\\n        (F.col(\\\"order_name\\\").contains(\\\"December\\\")) &\\n        (F.col(\\\"order_id\\\") > 100000) & (F.col(\\\"order_id\\\") < 105000),\\n        F.concat(F.lit(\\\"2021 \\\"), F.split(F.col(\\\"order_name\\\"), \\\"-\\\").getItem(0))\\n    )\\n    .when(\\n        F.col(\\\"order_name\\\").contains(\\\"-\\\"),\\n        F.concat(F.year(F.col(\\\"inserted_date\\\")).cast(\\\"string\\\"), F.lit(\\\" \\\"), F.split(F.col(\\\"order_name\\\"), \\\"-\\\").getItem(0))\\n    )\\n    .when(\\n        F.col(\\\"order_name\\\").contains(\\\"Restaurant Depot\\\") & (~F.col(\\\"order_name\\\").contains(\\\"-\\\")),\\n        F.concat(F.year(F.col(\\\"inserted_date\\\")).cast(\\\"string\\\"), F.lit(\\\" \\\"), F.split(F.col(\\\"order_name\\\"), \\\"Restaurant Depot\\\").getItem(0))\\n    )\\n)\\n\\ndf = df.withColumn(\\\"ModifiedDate\\\", F.regexp_replace(F.col(\\\"ModifiedDate\\\"), \\\"Februray\\\", \\\"February\\\"))\\ndf = df.withColumn(\\\"ModifiedDate\\\", F.to_date(\\\"ModifiedDate\\\"))\\ndf = df.withColumn(\\\"ModifiedDate\\\", F.when(F.col(\\\"ModifiedDate\\\").isNull(), F.col(\\\"inserted_date\\\")).otherwise(F.col(\\\"ModifiedDate\\\")))\\ndf = df.withColumn(\\\"ModifiedDate\\\", F.when(F.col(\\\"ModifiedDate\\\").isNull(), F.col(\\\"pickup_date\\\")).otherwise(F.col(\\\"ModifiedDate\\\")))\\ndf = df.withColumn(\\\"ModifiedDate\\\", F.to_timestamp(\\\"ModifiedDate\\\"))\\ndf = df.withColumn(\\\"ModifiedDate\\\", F.to_date(\\\"ModifiedDate\\\"))\\n\\ndf = df.filter(F.col(\\\"ModifiedDate\\\") >= F.lit(\\\"2017-01-01\\\"))\\n\\ndf = df.withColumn(\\\"order_name\\\", F.regexp_replace(F.col(\\\"order_name\\\"), \\\" Route\\\", \\\" routes)\\\"))\\ndf = df.withColumn(\\\"route_count\\\", F.col(\\\"route_count\\\").cast(\\\"int\\\"))\\n\\ndf = df.withColumn(\\\"pack_price\\\",\\n    F.when(\\n        (F.col(\\\"sender_name\\\") == \\\"Rose\\\") &\\n        (~F.col(\\\"order_name\\\").contains(\\\"Flowers supply & boxes\\\")) &\\n        (F.col(\\\"order_id\\\") < 85490),\\n        F.col(\\\"route_count\\\") * 7.5\\n    )\\n    .when(\\n        (F.col(\\\"sender_name\\\") == \\\"Rose\\\") &\\n        (~F.col(\\\"order_name\\\").contains(\\\"Flowers supply & boxes\\\")) &\\n        (F.col(\\\"order_id\\\") >= 85490),\\n        F.col(\\\"route_count\\\") * 8.5\\n    )\\n    .when(\\n        (F.col(\\\"company_name_id\\\").contains(\\\"Curogram\\\")) &\\n        (F.col(\\\"order_id\\\") <= 102661),\\n        F.col(\\\"route_count\\\") * 15\\n    )\\n    .when(\\n        (F.col(\\\"sender_name\\\") == \\\"Stanford\\\") &\\n        ((F.col(\\\"order_name\\\").contains(\\\"Deliver to Lab\\\")) | (F.col(\\\"order_name\\\").contains(\\\"Multiple drop offs\\\"))) &\\n        ((F.col(\\\"pack_price\\\") / F.col(\\\"route_count\\\")) < 25),\\n        F.col(\\\"route_count\\\") * 17\\n    )\\n    .otherwise(F.col(\\\"pack_price\\\"))\\n)\\n\\ndf = df.withColumn(\\n    \\\"company_name_id\\\",\\n    F.when(F.col(\\\"company_name_id\\\") == \\\"Rosecart\\\", \\\"Rose Cart\\\")\\n    .when(F.col(\\\"company_name_id\\\") == \\\"w.benarto@hanagroup.us\\\", \\\"Sushi delivery (SF)\\\")\\n    .when(F.col(\\\"company_name_id\\\") == \\\"m.ramirez@genjiweb.com\\\", \\\"Sushi Delivery (Mill Valley)\\\")\\n    .when(F.col(\\\"company_name_id\\\") == \\\"manager.062@jetrord.com\\\", \\\"Restaurant Depot San Jose\\\")\\n    .when(F.col(\\\"company_name_id\\\").isin(\\\"sofya.yaro@cityhealthuc.com\\\", \\\"bwaqa@cityhealthuc.com\\\"), \\\"CityHealth\\\")\\n    .when(F.col(\\\"company_name_id\\\").isin(\\\"OfftheGridSF\\\", \\\"melody.yeung@offthegridsf.com\\\", \\\"dylan.lester@offthegridsf.com\\\"), \\\"Off The Grid Grocery\\\")\\n    .when(F.col(\\\"company_name_id\\\") == \\\"bluebottle@senpex.com\\\", \\\"Blue Bottle Coffee\\\")\\n    .otherwise(F.col(\\\"company_name_id\\\"))\\n)\\n\\ndf = df.withColumn(\\\"pack_price\\\", F.col(\\\"pack_price\\\").cast(\\\"double\\\"))\\n\\ndf = df.select(\\n    \\\"ModifiedDate\\\", \\\"order_id\\\", \\\"order_name\\\", \\\"inserted_date\\\",\\n    \\\"description_text\\\", \\\"sender_name\\\", \\\"route_count\\\", \\\"pack_price\\\",\\n    \\\"courier_profit\\\", \\\"pack_status\\\", \\\"pickup_date\\\"\\n)\\n\\noutput_dyf = DynamicFrame.fromDF(df, glueContext, \\\"output_dyf\\\")\\nreturn DynamicFrameCollection({\\\"CustomTransform\\\": output_dyf}, glueContext)\",\"Inputs\":[\"node-1745372950157\"],\"Name\":\"Custom Transform\"}},\"node-1745371332319\":{\"SparkSQL\":{\"Inputs\":[\"node-1745356503984\",\"node-1745354166507\"],\"Name\":\"SQL Query\",\"SqlAliases\":[{\"Alias\":\"us_collection_service\",\"From\":\"node-1745356503984\"},{\"Alias\":\"us_deliveries\",\"From\":\"node-1745354166507\"}],\"SqlQuery\":\"select * from us_deliveries\\nunion all \\nselect * from us_collection_service\"}},\"node-1745356398241\":{\"S3ParquetSource\":{\"AdditionalOptions\":{\"EnableSamplePath\":false,\"SamplePath\":\"s3://senpex-cdc-iceberg/collectors/order_details/20250422-171652308.parquet\"},\"Exclusions\":[],\"Name\":\"collectors_order_details\",\"OutputSchemas\":[{\"Columns\":[{\"Name\":\"Op\",\"Type\":\"string\"},{\"Name\":\"id\",\"Type\":\"int\"},{\"Name\":\"order_id\",\"Type\":\"int\"},{\"Name\":\"upc\",\"Type\":\"string\"},{\"Name\":\"item_id\",\"Type\":\"string\"},{\"Name\":\"desciption\",\"Type\":\"string\"},{\"Name\":\"category\",\"Type\":\"string\"},{\"Name\":\"unit\",\"Type\":\"string\"},{\"Name\":\"bin\",\"Type\":\"string\"},{\"Name\":\"qty\",\"Type\":\"string\"},{\"Name\":\"price\",\"Type\":\"string\"},{\"Name\":\"subtotal\",\"Type\":\"string\"},{\"Name\":\"email\",\"Type\":\"string\"},{\"Name\":\"shop_id\",\"Type\":\"int\"},{\"Name\":\"is_collected\",\"Type\":\"int\"},{\"Name\":\"collected_date\",\"Type\":\"string\"},{\"Name\":\"qty2\",\"Type\":\"int\"},{\"Name\":\"unit_org\",\"Type\":\"string\"},{\"Name\":\"sub\",\"Type\":\"string\"}]}],\"Paths\":[\"s3://senpex-cdc-iceberg/collectors/order_details/\"],\"Recurse\":true}},\"node-1745353732624\":{\"S3ParquetSource\":{\"AdditionalOptions\":{\"EnableSamplePath\":false,\"SamplePath\":\"s3://senpex-cdc-iceberg/senpex_vers3/pack_details/20250411-001747716.parquet\"},\"Exclusions\":[],\"Name\":\"senpex_vers3_pack_details\",\"OutputSchemas\":[{\"Columns\":[{\"Name\":\"Op\",\"Type\":\"string\"},{\"Name\":\"id\",\"Type\":\"int\"},{\"Name\":\"pack_id\",\"Type\":\"int\"},{\"Name\":\"tariff_id\",\"Type\":\"int\"},{\"Name\":\"pack_cr_client\",\"Type\":\"int\"},{\"Name\":\"org_cust_price\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"org_courier_price\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"promo_code\",\"Type\":\"string\"},{\"Name\":\"waiting_mins\",\"Type\":\"int\"},{\"Name\":\"pc_cust_perc\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"pc_courier_perc\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"time_cust_perc\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"time_courier_perc\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"late_type\",\"Type\":\"int\"},{\"Name\":\"driver_pickup_late_mins\",\"Type\":\"int\"},{\"Name\":\"driver_dropoff_late_mins\",\"Type\":\"int\"},{\"Name\":\"owner_late_lost_amount\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"driver_waiting_mins\",\"Type\":\"int\"},{\"Name\":\"driver_waiting_profit\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"owner_waiting_amount\",\"Type\":\"int\"},{\"Name\":\"driver_toll_amount\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"ownwer_toll_amount\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"parking_pickup_amount\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"parking_dropoff_amount\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"add_notes\",\"Type\":\"string\"},{\"Name\":\"add_pay_status\",\"Type\":\"int\"},{\"Name\":\"pack_source_id\",\"Type\":\"int\"},{\"Name\":\"pack_code_id\",\"Type\":\"string\"},{\"Name\":\"pk_company_id\",\"Type\":\"int\"},{\"Name\":\"route_count\",\"Type\":\"int\"},{\"Name\":\"company_cust_perc\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"company_courier_perc\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"pack_ip_address\",\"Type\":\"string\"},{\"Name\":\"shedule_type\",\"Type\":\"int\"},{\"Name\":\"flat_rate_id\",\"Type\":\"int\"},{\"Name\":\"hour_price\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"courier_hour_profit\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"owner_hour_profit\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"schedule_template_id\",\"Type\":\"int\"},{\"Name\":\"pack_map_img\",\"Type\":\"string\"},{\"Name\":\"pack_guid\",\"Type\":\"string\"},{\"Name\":\"pcontrol_status\",\"Type\":\"int\"},{\"Name\":\"pack_mailing_status\",\"Type\":\"int\"},{\"Name\":\"api_vers\",\"Type\":\"int\"},{\"Name\":\"pk_state_id\",\"Type\":\"int\"},{\"Name\":\"rest_api_vers\",\"Type\":\"int\"},{\"Name\":\"ask_sign\",\"Type\":\"int\"},{\"Name\":\"state_id\",\"Type\":\"int\"},{\"Name\":\"pk_timezone\",\"Type\":\"int\"},{\"Name\":\"pk_qrcode\",\"Type\":\"int\"},{\"Name\":\"pk_work_type\",\"Type\":\"int\"},{\"Name\":\"pk_qrcode_data\",\"Type\":\"string\"},{\"Name\":\"pk_check_qrcode\",\"Type\":\"int\"},{\"Name\":\"pk_return_id\",\"Type\":\"int\"},{\"Name\":\"pack_group_id\",\"Type\":\"int\"},{\"Name\":\"rec_pack_count\",\"Type\":\"int\"},{\"Name\":\"pack_send_new_nots\",\"Type\":\"int\"},{\"Name\":\"pk_timezone2\",\"Type\":\"int\"},{\"Name\":\"dis_rate\",\"Type\":\"int\"},{\"Name\":\"pack_tip\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"remote_order_id\",\"Type\":\"string\"},{\"Name\":\"rate_status\",\"Type\":\"int\"},{\"Name\":\"service_tariff_id\",\"Type\":\"int\"},{\"Name\":\"docusign_enabled\",\"Type\":\"int\"},{\"Name\":\"include_rating\",\"Type\":\"int\"},{\"Name\":\"request_barcode\",\"Type\":\"int\"},{\"Name\":\"parking_mode\",\"Type\":\"int\"},{\"Name\":\"return_routes\",\"Type\":\"int\"},{\"Name\":\"pickup_parking_slot\",\"Type\":\"string\"},{\"Name\":\"return_parking_slot\",\"Type\":\"string\"},{\"Name\":\"details_vers\",\"Type\":\"int\"},{\"Name\":\"item_list_enabled\",\"Type\":\"int\"},{\"Name\":\"request_security_code\",\"Type\":\"int\"}]}],\"Paths\":[\"s3://senpex-cdc-iceberg/senpex_vers3/pack_details/\"],\"Recurse\":true}},\"node-1745353692233\":{\"S3ParquetSource\":{\"AdditionalOptions\":{\"EnableSamplePath\":false,\"SamplePath\":\"s3://senpex-cdc-iceberg/senpex_vers3/packages/20250411-001828459.parquet\"},\"Exclusions\":[],\"Name\":\"senpex_vers3_packages\",\"OutputSchemas\":[{\"Columns\":[{\"Name\":\"Op\",\"Type\":\"string\"},{\"Name\":\"id\",\"Type\":\"int\"},{\"Name\":\"send_name\",\"Type\":\"string\"},{\"Name\":\"send_cat_id\",\"Type\":\"int\"},{\"Name\":\"pack_size_id\",\"Type\":\"int\"},{\"Name\":\"pack_options_id\",\"Type\":\"int\"},{\"Name\":\"pack_weight\",\"Type\":\"int\"},{\"Name\":\"pet_type\",\"Type\":\"int\"},{\"Name\":\"pet_count\",\"Type\":\"int\"},{\"Name\":\"pet_is_vac\",\"Type\":\"int\"},{\"Name\":\"item_value\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"desc_text\",\"Type\":\"string\"},{\"Name\":\"pack_from_lat\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"pack_from_lng\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"pack_from_text\",\"Type\":\"string\"},{\"Name\":\"pack_to_lat\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"pack_to_lng\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"pack_to_text\",\"Type\":\"string\"},{\"Name\":\"distance\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"distance_time\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"taken_time\",\"Type\":\"timestamp\"},{\"Name\":\"taken_type\",\"Type\":\"int\"},{\"Name\":\"taken_asap\",\"Type\":\"int\"},{\"Name\":\"taken_bring_type\",\"Type\":\"int\"},{\"Name\":\"delivery_time\",\"Type\":\"timestamp\"},{\"Name\":\"delivery_type\",\"Type\":\"int\"},{\"Name\":\"delivery_asap\",\"Type\":\"int\"},{\"Name\":\"delivery_take_type\",\"Type\":\"string\"},{\"Name\":\"receiver_name\",\"Type\":\"string\"},{\"Name\":\"receiver_phone_number\",\"Type\":\"string\"},{\"Name\":\"leave_by_door\",\"Type\":\"int\"},{\"Name\":\"pack_price\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"pack_price_with_ins\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"pack_price_without_ins\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"pack_refund_amount\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"insurance_price\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"insurance_owner_price\",\"Type\":\"string\"},{\"Name\":\"is_insurance_payed\",\"Type\":\"int\"},{\"Name\":\"courier_profit\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"owner_profit\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"bank_fee\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"tax_fee\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"stripe_payout_fee\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"insurance_mode\",\"Type\":\"int\"},{\"Name\":\"pack_status\",\"Type\":\"int\"},{\"Name\":\"pack_owner_id\",\"Type\":\"int\"},{\"Name\":\"inserted_by\",\"Type\":\"int\"},{\"Name\":\"inserted_date\",\"Type\":\"timestamp\"},{\"Name\":\"updated_by\",\"Type\":\"int\"},{\"Name\":\"updated_date\",\"Type\":\"timestamp\"},{\"Name\":\"accepted_courier_id\",\"Type\":\"int\"},{\"Name\":\"sender_paid\",\"Type\":\"int\"},{\"Name\":\"courier_paid\",\"Type\":\"int\"},{\"Name\":\"stripe_id\",\"Type\":\"string\"},{\"Name\":\"last_operation_time\",\"Type\":\"timestamp\"},{\"Name\":\"pack_code_guid\",\"Type\":\"string\"},{\"Name\":\"pack_sort_id\",\"Type\":\"int\"},{\"Name\":\"pack_transport_id\",\"Type\":\"int\"},{\"Name\":\"pk_payment_type\",\"Type\":\"int\"},{\"Name\":\"sender_name\",\"Type\":\"string\"},{\"Name\":\"sender_cell\",\"Type\":\"string\"},{\"Name\":\"sender_desc\",\"Type\":\"string\"},{\"Name\":\"dn_promo_code_id\",\"Type\":\"int\"},{\"Name\":\"sender_paid_real\",\"Type\":\"int\"},{\"Name\":\"force_img_ondeliv\",\"Type\":\"int\"},{\"Name\":\"lc_company_id\",\"Type\":\"int\"},{\"Name\":\"order_type\",\"Type\":\"int\"},{\"Name\":\"finish_module\",\"Type\":\"int\"},{\"Name\":\"sender_cell_prefix\",\"Type\":\"string\"},{\"Name\":\"refund_type\",\"Type\":\"int\"},{\"Name\":\"custom_weight\",\"Type\":\"int\"},{\"Name\":\"pack_from_apt\",\"Type\":\"string\"},{\"Name\":\"pack_to_apt\",\"Type\":\"string\"},{\"Name\":\"courier_service_price\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"custom_height\",\"Type\":\"int\"},{\"Name\":\"custom_length\",\"Type\":\"int\"},{\"Name\":\"custom_width\",\"Type\":\"int\"},{\"Name\":\"service_price\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"driver_count\",\"Type\":\"int\"},{\"Name\":\"helper_count\",\"Type\":\"int\"},{\"Name\":\"schedule_date\",\"Type\":\"timestamp\"},{\"Name\":\"app_version\",\"Type\":\"int\"},{\"Name\":\"discount\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"toll_price\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"tip_amount\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"sms_price\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"pack_from_state\",\"Type\":\"string\"},{\"Name\":\"pack_from_city\",\"Type\":\"string\"},{\"Name\":\"pack_from_street\",\"Type\":\"string\"},{\"Name\":\"pack_from_zip\",\"Type\":\"string\"},{\"Name\":\"pack_from_country\",\"Type\":\"string\"},{\"Name\":\"total_price_without_tax\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"tax_perc\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"tax_price\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"total_charge_price\",\"Type\":\"decimal(10,2)\"}]}],\"Paths\":[\"s3://senpex-cdc-iceberg/senpex_vers3/packages/\"],\"Recurse\":true}},\"node-1745372517781\":{\"DynamicTransform\":{\"FunctionName\":\"gs_derived\",\"Inputs\":[\"node-1745371332319\"],\"Name\":\"Derived Column\",\"Parameters\":[{\"IsOptional\":false,\"Name\":\"colName\",\"Type\":\"str\",\"Value\":[\"inserted_date_original\"]},{\"IsOptional\":false,\"Name\":\"expr\",\"Type\":\"str\",\"Value\":[\"inserted_date\"]}],\"Path\":\"s3://aws-glue-studio-transforms-510798373988-prod-us-east-1/gs_derived.py\",\"TransformName\":\"gs_derived\",\"Version\":\"1.0.0\"}},\"node-1745353931638\":{\"S3ParquetSource\":{\"AdditionalOptions\":{\"EnableSamplePath\":false,\"SamplePath\":\"s3://senpex-cdc-iceberg/senpex_vers3/shippo_list/LOAD00000001.parquet\"},\"Exclusions\":[],\"Name\":\"senpex_vers3_shippo_list\",\"OutputSchemas\":[{\"Columns\":[{\"Name\":\"id\",\"Type\":\"int\"},{\"Name\":\"order_id\",\"Type\":\"int\"},{\"Name\":\"from_name\",\"Type\":\"string\"},{\"Name\":\"from_street\",\"Type\":\"string\"},{\"Name\":\"from_city\",\"Type\":\"string\"},{\"Name\":\"from_state\",\"Type\":\"string\"},{\"Name\":\"from_zip\",\"Type\":\"string\"},{\"Name\":\"from_country\",\"Type\":\"string\"},{\"Name\":\"from_email\",\"Type\":\"string\"},{\"Name\":\"from_phone\",\"Type\":\"string\"},{\"Name\":\"to_name\",\"Type\":\"string\"},{\"Name\":\"to_street\",\"Type\":\"string\"},{\"Name\":\"to_city\",\"Type\":\"string\"},{\"Name\":\"to_state\",\"Type\":\"string\"},{\"Name\":\"to_zip\",\"Type\":\"string\"},{\"Name\":\"to_country\",\"Type\":\"string\"},{\"Name\":\"to_phone\",\"Type\":\"string\"},{\"Name\":\"parcel_length\",\"Type\":\"string\"},{\"Name\":\"parcel_width\",\"Type\":\"string\"},{\"Name\":\"parcel_height\",\"Type\":\"string\"},{\"Name\":\"parcel_distance_unit\",\"Type\":\"string\"},{\"Name\":\"parcel_weight\",\"Type\":\"string\"},{\"Name\":\"parcel_mass_unit\",\"Type\":\"string\"},{\"Name\":\"object_id\",\"Type\":\"string\"},{\"Name\":\"rate_results\",\"Type\":\"string\"},{\"Name\":\"trans_results\",\"Type\":\"string\"},{\"Name\":\"price_results\",\"Type\":\"string\"},{\"Name\":\"pack_details\",\"Type\":\"string\"},{\"Name\":\"refund_results\",\"Type\":\"string\"},{\"Name\":\"label_fil_type\",\"Type\":\"string\"},{\"Name\":\"label_url\",\"Type\":\"string\"},{\"Name\":\"tracking_number\",\"Type\":\"string\"},{\"Name\":\"tracking_url_provider\",\"Type\":\"string\"},{\"Name\":\"error_messages\",\"Type\":\"string\"},{\"Name\":\"status_id\",\"Type\":\"string\"},{\"Name\":\"inserted_date\",\"Type\":\"timestamp\"},{\"Name\":\"inserted_by\",\"Type\":\"int\"},{\"Name\":\"amount\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"currency\",\"Type\":\"string\"},{\"Name\":\"created_user_id\",\"Type\":\"int\"},{\"Name\":\"created_user_pass\",\"Type\":\"int\"},{\"Name\":\"pay_guid\",\"Type\":\"string\"},{\"Name\":\"pack_price\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"total_price\",\"Type\":\"string\"},{\"Name\":\"email_sent_customer\",\"Type\":\"timestamp\"},{\"Name\":\"email_sent_customer_cnt\",\"Type\":\"int\"},{\"Name\":\"sender_user_id\",\"Type\":\"int\"},{\"Name\":\"from_street2\",\"Type\":\"string\"},{\"Name\":\"to_street2\",\"Type\":\"string\"},{\"Name\":\"shippo_token\",\"Type\":\"string\"},{\"Name\":\"parcel_template\",\"Type\":\"string\"},{\"Name\":\"shippo_source\",\"Type\":\"string\"},{\"Name\":\"trans_id\",\"Type\":\"string\"},{\"Name\":\"status_update_date\",\"Type\":\"timestamp\"},{\"Name\":\"to_lat\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"to_lng\",\"Type\":\"decimal(10,2)\"}]}],\"Paths\":[\"s3://senpex-cdc-iceberg/senpex_vers3/shippo_list/\"],\"Recurse\":true}},\"node-1745353928470\":{\"S3ParquetSource\":{\"AdditionalOptions\":{\"EnableSamplePath\":false,\"SamplePath\":\"s3://senpex-cdc-iceberg/senpex_vers3/payouts/LOAD00000001.parquet\"},\"Exclusions\":[],\"Name\":\"senpex_vers3_payouts\",\"OutputSchemas\":[{\"Columns\":[{\"Name\":\"id\",\"Type\":\"int\"},{\"Name\":\"paid_id\",\"Type\":\"int\"},{\"Name\":\"user_id\",\"Type\":\"int\"},{\"Name\":\"payment_amount\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"payout_date\",\"Type\":\"timestamp\"},{\"Name\":\"is_paid\",\"Type\":\"int\"},{\"Name\":\"inserted_by\",\"Type\":\"int\"},{\"Name\":\"inserted_date\",\"Type\":\"string\"},{\"Name\":\"paid_date\",\"Type\":\"string\"},{\"Name\":\"owner_profit\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"insurance_profit\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"bank_com_fee\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"tax_fee\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"stripe_payout_fee\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"delivery_count\",\"Type\":\"int\"}]}],\"Paths\":[\"s3://senpex-cdc-iceberg/senpex_vers3/payouts/\"],\"Recurse\":true}},\"node-1745353735176\":{\"S3ParquetSource\":{\"AdditionalOptions\":{\"EnableSamplePath\":false,\"SamplePath\":\"s3://senpex-cdc-iceberg/senpex_vers3/pack_tips/20250422-164633099.parquet\"},\"Exclusions\":[],\"Name\":\"senpex_vers3_pack_tips\",\"OutputSchemas\":[{\"Columns\":[{\"Name\":\"Op\",\"Type\":\"string\"},{\"Name\":\"id\",\"Type\":\"int\"},{\"Name\":\"pack_id\",\"Type\":\"int\"},{\"Name\":\"sender_id\",\"Type\":\"int\"},{\"Name\":\"courier_id\",\"Type\":\"int\"},{\"Name\":\"paid_amount\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"is_paid\",\"Type\":\"int\"},{\"Name\":\"payout_id\",\"Type\":\"int\"},{\"Name\":\"tip_courier_profit\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"tip_owner_profit\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"tip_bank_fee\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"tip_tax_fee\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"tip_stripe_fee\",\"Type\":\"string\"},{\"Name\":\"pay_type\",\"Type\":\"int\"},{\"Name\":\"org_amount\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"pt_cmt\",\"Type\":\"string\"},{\"Name\":\"tip_stripe_id\",\"Type\":\"string\"},{\"Name\":\"tip_given_type\",\"Type\":\"int\"}]}],\"Paths\":[\"s3://senpex-cdc-iceberg/senpex_vers3/pack_tips/\"],\"Recurse\":true}},\"node-1745353929774\":{\"S3ParquetSource\":{\"AdditionalOptions\":{\"EnableSamplePath\":false,\"SamplePath\":\"s3://senpex-cdc-iceberg/senpex_vers3/payout_details/LOAD00000001.parquet\"},\"Exclusions\":[],\"Name\":\"senpex_vers3_payout_details\",\"OutputSchemas\":[{\"Columns\":[{\"Name\":\"id\",\"Type\":\"int\"},{\"Name\":\"payout_id\",\"Type\":\"int\"},{\"Name\":\"payment_module\",\"Type\":\"int\"},{\"Name\":\"payment_module_id\",\"Type\":\"int\"},{\"Name\":\"payment_amount\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"pack_id\",\"Type\":\"int\"},{\"Name\":\"owner_profit\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"insurance_profit\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"bank_com_fee\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"tax_fee\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"stripe_fee\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"uq_guid\",\"Type\":\"string\"},{\"Name\":\"order_sending_name\",\"Type\":\"string\"},{\"Name\":\"pm_id\",\"Type\":\"int\"}]}],\"Paths\":[\"s3://senpex-cdc-iceberg/senpex_vers3/payout_details/\"],\"Recurse\":true}},\"node-1745353734481\":{\"S3ParquetSource\":{\"AdditionalOptions\":{\"EnableSamplePath\":false,\"SamplePath\":\"s3://senpex-cdc-iceberg/senpex_vers3/dic_list/LOAD00000001.parquet\"},\"Exclusions\":[],\"Name\":\"senpex_vers3_dic_list\",\"OutputSchemas\":[{\"Columns\":[{\"Name\":\"id\",\"Type\":\"int\"},{\"Name\":\"dic_id\",\"Type\":\"int\"},{\"Name\":\"list_name\",\"Type\":\"string\"},{\"Name\":\"list_priority\",\"Type\":\"int\"},{\"Name\":\"options_id\",\"Type\":\"int\"},{\"Name\":\"options_text\",\"Type\":\"string\"},{\"Name\":\"enabled\",\"Type\":\"int\"},{\"Name\":\"list_id\",\"Type\":\"int\"},{\"Name\":\"rules_text\",\"Type\":\"string\"},{\"Name\":\"list_short\",\"Type\":\"string\"},{\"Name\":\"list_value\",\"Type\":\"string\"},{\"Name\":\"list_icon\",\"Type\":\"string\"},{\"Name\":\"list_vers\",\"Type\":\"int\"}]}],\"Paths\":[\"s3://senpex-cdc-iceberg/senpex_vers3/dic_list/\"],\"Recurse\":true}},\"node-1745354166507\":{\"SparkSQL\":{\"Inputs\":[\"node-1745353692233\",\"node-1745353732624\",\"node-1745353733832\",\"node-1745353734481\",\"node-1745353735176\",\"node-1745353735984\",\"node-1745353927278\",\"node-1745353928470\",\"node-1745353929774\",\"node-1745353931638\",\"node-1745354071485\"],\"Name\":\"us_deliveries\",\"OutputSchemas\":[{\"Columns\":[{\"Name\":\"Op\",\"Type\":\"string\"},{\"Name\":\"id\",\"Type\":\"int\"},{\"Name\":\"send_name\",\"Type\":\"string\"},{\"Name\":\"send_cat_id\",\"Type\":\"int\"},{\"Name\":\"pack_size_id\",\"Type\":\"int\"},{\"Name\":\"pack_options_id\",\"Type\":\"int\"},{\"Name\":\"pack_weight\",\"Type\":\"int\"},{\"Name\":\"pet_type\",\"Type\":\"int\"},{\"Name\":\"pet_count\",\"Type\":\"int\"},{\"Name\":\"pet_is_vac\",\"Type\":\"int\"},{\"Name\":\"item_value\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"desc_text\",\"Type\":\"string\"},{\"Name\":\"pack_from_lat\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"pack_from_lng\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"pack_from_text\",\"Type\":\"string\"},{\"Name\":\"pack_to_lat\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"pack_to_lng\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"pack_to_text\",\"Type\":\"string\"},{\"Name\":\"distance\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"distance_time\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"taken_time\",\"Type\":\"timestamp\"},{\"Name\":\"taken_type\",\"Type\":\"int\"},{\"Name\":\"taken_asap\",\"Type\":\"int\"},{\"Name\":\"taken_bring_type\",\"Type\":\"int\"},{\"Name\":\"delivery_time\",\"Type\":\"timestamp\"},{\"Name\":\"delivery_type\",\"Type\":\"int\"},{\"Name\":\"delivery_asap\",\"Type\":\"int\"},{\"Name\":\"delivery_take_type\",\"Type\":\"string\"},{\"Name\":\"receiver_name\",\"Type\":\"string\"},{\"Name\":\"receiver_phone_number\",\"Type\":\"string\"},{\"Name\":\"leave_by_door\",\"Type\":\"int\"},{\"Name\":\"pack_price\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"pack_price_with_ins\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"pack_price_without_ins\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"pack_refund_amount\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"insurance_price\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"insurance_owner_price\",\"Type\":\"string\"},{\"Name\":\"is_insurance_payed\",\"Type\":\"int\"},{\"Name\":\"courier_profit\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"owner_profit\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"bank_fee\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"tax_fee\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"stripe_payout_fee\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"insurance_mode\",\"Type\":\"int\"},{\"Name\":\"pack_status\",\"Type\":\"int\"},{\"Name\":\"pack_owner_id\",\"Type\":\"int\"},{\"Name\":\"inserted_by\",\"Type\":\"int\"},{\"Name\":\"inserted_date\",\"Type\":\"timestamp\"},{\"Name\":\"updated_by\",\"Type\":\"int\"},{\"Name\":\"updated_date\",\"Type\":\"timestamp\"},{\"Name\":\"accepted_courier_id\",\"Type\":\"int\"},{\"Name\":\"sender_paid\",\"Type\":\"int\"},{\"Name\":\"courier_paid\",\"Type\":\"int\"},{\"Name\":\"stripe_id\",\"Type\":\"string\"},{\"Name\":\"last_operation_time\",\"Type\":\"timestamp\"},{\"Name\":\"pack_code_guid\",\"Type\":\"string\"},{\"Name\":\"pack_sort_id\",\"Type\":\"int\"},{\"Name\":\"pack_transport_id\",\"Type\":\"int\"},{\"Name\":\"pk_payment_type\",\"Type\":\"int\"},{\"Name\":\"sender_name\",\"Type\":\"string\"},{\"Name\":\"sender_cell\",\"Type\":\"string\"},{\"Name\":\"sender_desc\",\"Type\":\"string\"},{\"Name\":\"dn_promo_code_id\",\"Type\":\"int\"},{\"Name\":\"sender_paid_real\",\"Type\":\"int\"},{\"Name\":\"force_img_ondeliv\",\"Type\":\"int\"},{\"Name\":\"lc_company_id\",\"Type\":\"int\"},{\"Name\":\"order_type\",\"Type\":\"int\"},{\"Name\":\"finish_module\",\"Type\":\"int\"},{\"Name\":\"sender_cell_prefix\",\"Type\":\"string\"},{\"Name\":\"refund_type\",\"Type\":\"int\"},{\"Name\":\"custom_weight\",\"Type\":\"int\"},{\"Name\":\"pack_from_apt\",\"Type\":\"string\"},{\"Name\":\"pack_to_apt\",\"Type\":\"string\"},{\"Name\":\"courier_service_price\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"custom_height\",\"Type\":\"int\"},{\"Name\":\"custom_length\",\"Type\":\"int\"},{\"Name\":\"custom_width\",\"Type\":\"int\"},{\"Name\":\"service_price\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"driver_count\",\"Type\":\"int\"},{\"Name\":\"helper_count\",\"Type\":\"int\"},{\"Name\":\"schedule_date\",\"Type\":\"timestamp\"},{\"Name\":\"app_version\",\"Type\":\"int\"},{\"Name\":\"discount\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"toll_price\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"tip_amount\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"sms_price\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"pack_from_state\",\"Type\":\"string\"},{\"Name\":\"pack_from_city\",\"Type\":\"string\"},{\"Name\":\"pack_from_street\",\"Type\":\"string\"},{\"Name\":\"pack_from_zip\",\"Type\":\"string\"},{\"Name\":\"pack_from_country\",\"Type\":\"string\"},{\"Name\":\"total_price_without_tax\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"tax_perc\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"tax_price\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"total_charge_price\",\"Type\":\"decimal(10,2)\"}]},{\"Columns\":[{\"Name\":\"Op\",\"Type\":\"string\"},{\"Name\":\"id\",\"Type\":\"int\"},{\"Name\":\"pack_id\",\"Type\":\"int\"},{\"Name\":\"tariff_id\",\"Type\":\"int\"},{\"Name\":\"pack_cr_client\",\"Type\":\"int\"},{\"Name\":\"org_cust_price\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"org_courier_price\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"promo_code\",\"Type\":\"string\"},{\"Name\":\"waiting_mins\",\"Type\":\"int\"},{\"Name\":\"pc_cust_perc\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"pc_courier_perc\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"time_cust_perc\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"time_courier_perc\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"late_type\",\"Type\":\"int\"},{\"Name\":\"driver_pickup_late_mins\",\"Type\":\"int\"},{\"Name\":\"driver_dropoff_late_mins\",\"Type\":\"int\"},{\"Name\":\"owner_late_lost_amount\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"driver_waiting_mins\",\"Type\":\"int\"},{\"Name\":\"driver_waiting_profit\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"owner_waiting_amount\",\"Type\":\"int\"},{\"Name\":\"driver_toll_amount\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"ownwer_toll_amount\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"parking_pickup_amount\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"parking_dropoff_amount\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"add_notes\",\"Type\":\"string\"},{\"Name\":\"add_pay_status\",\"Type\":\"int\"},{\"Name\":\"pack_source_id\",\"Type\":\"int\"},{\"Name\":\"pack_code_id\",\"Type\":\"string\"},{\"Name\":\"pk_company_id\",\"Type\":\"int\"},{\"Name\":\"route_count\",\"Type\":\"int\"},{\"Name\":\"company_cust_perc\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"company_courier_perc\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"pack_ip_address\",\"Type\":\"string\"},{\"Name\":\"shedule_type\",\"Type\":\"int\"},{\"Name\":\"flat_rate_id\",\"Type\":\"int\"},{\"Name\":\"hour_price\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"courier_hour_profit\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"owner_hour_profit\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"schedule_template_id\",\"Type\":\"int\"},{\"Name\":\"pack_map_img\",\"Type\":\"string\"},{\"Name\":\"pack_guid\",\"Type\":\"string\"},{\"Name\":\"pcontrol_status\",\"Type\":\"int\"},{\"Name\":\"pack_mailing_status\",\"Type\":\"int\"},{\"Name\":\"api_vers\",\"Type\":\"int\"},{\"Name\":\"pk_state_id\",\"Type\":\"int\"},{\"Name\":\"rest_api_vers\",\"Type\":\"int\"},{\"Name\":\"ask_sign\",\"Type\":\"int\"},{\"Name\":\"state_id\",\"Type\":\"int\"},{\"Name\":\"pk_timezone\",\"Type\":\"int\"},{\"Name\":\"pk_qrcode\",\"Type\":\"int\"},{\"Name\":\"pk_work_type\",\"Type\":\"int\"},{\"Name\":\"pk_qrcode_data\",\"Type\":\"string\"},{\"Name\":\"pk_check_qrcode\",\"Type\":\"int\"},{\"Name\":\"pk_return_id\",\"Type\":\"int\"},{\"Name\":\"pack_group_id\",\"Type\":\"int\"},{\"Name\":\"rec_pack_count\",\"Type\":\"int\"},{\"Name\":\"pack_send_new_nots\",\"Type\":\"int\"},{\"Name\":\"pk_timezone2\",\"Type\":\"int\"},{\"Name\":\"dis_rate\",\"Type\":\"int\"},{\"Name\":\"pack_tip\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"remote_order_id\",\"Type\":\"string\"},{\"Name\":\"rate_status\",\"Type\":\"int\"},{\"Name\":\"service_tariff_id\",\"Type\":\"int\"},{\"Name\":\"docusign_enabled\",\"Type\":\"int\"},{\"Name\":\"include_rating\",\"Type\":\"int\"},{\"Name\":\"request_barcode\",\"Type\":\"int\"},{\"Name\":\"parking_mode\",\"Type\":\"int\"},{\"Name\":\"return_routes\",\"Type\":\"int\"},{\"Name\":\"pickup_parking_slot\",\"Type\":\"string\"},{\"Name\":\"return_parking_slot\",\"Type\":\"string\"},{\"Name\":\"details_vers\",\"Type\":\"int\"},{\"Name\":\"item_list_enabled\",\"Type\":\"int\"},{\"Name\":\"request_security_code\",\"Type\":\"int\"}]},{\"Columns\":[{\"Name\":\"Op\",\"Type\":\"string\"},{\"Name\":\"id\",\"Type\":\"int\"},{\"Name\":\"name\",\"Type\":\"string\"},{\"Name\":\"surname\",\"Type\":\"string\"},{\"Name\":\"cell\",\"Type\":\"string\"},{\"Name\":\"email\",\"Type\":\"string\"},{\"Name\":\"password\",\"Type\":\"string\"},{\"Name\":\"city\",\"Type\":\"string\"},{\"Name\":\"address_actual\",\"Type\":\"string\"},{\"Name\":\"address_offical\",\"Type\":\"string\"},{\"Name\":\"country\",\"Type\":\"string\"},{\"Name\":\"use_location\",\"Type\":\"int\"},{\"Name\":\"use_offical\",\"Type\":\"int\"},{\"Name\":\"gender\",\"Type\":\"int\"},{\"Name\":\"paypal_email\",\"Type\":\"string\"},{\"Name\":\"inserted_by\",\"Type\":\"int\"},{\"Name\":\"inserted_date\",\"Type\":\"timestamp\"},{\"Name\":\"updated_by\",\"Type\":\"int\"},{\"Name\":\"updated_date\",\"Type\":\"timestamp\"},{\"Name\":\"merital_status\",\"Type\":\"int\"},{\"Name\":\"referal_name\",\"Type\":\"string\"},{\"Name\":\"referal_cell\",\"Type\":\"string\"},{\"Name\":\"idcard_img1\",\"Type\":\"string\"},{\"Name\":\"idcard_img2\",\"Type\":\"string\"},{\"Name\":\"idcard_number\",\"Type\":\"string\"},{\"Name\":\"idcard_exp_date\",\"Type\":\"date\"},{\"Name\":\"idcatd_state\",\"Type\":\"string\"},{\"Name\":\"ssn_number\",\"Type\":\"string\"},{\"Name\":\"self_img\",\"Type\":\"string\"},{\"Name\":\"qst_health\",\"Type\":\"int\"},{\"Name\":\"qst_disability\",\"Type\":\"int\"},{\"Name\":\"qst_criminal\",\"Type\":\"int\"},{\"Name\":\"qst_sexsual\",\"Type\":\"int\"},{\"Name\":\"is_approved\",\"Type\":\"int\"},{\"Name\":\"avail_status\",\"Type\":\"int\"},{\"Name\":\"log_session_key\",\"Type\":\"string\"},{\"Name\":\"log_device_id\",\"Type\":\"string\"},{\"Name\":\"log_user_argent\",\"Type\":\"string\"},{\"Name\":\"log_date\",\"Type\":\"timestamp\"},{\"Name\":\"is_disabled\",\"Type\":\"int\"},{\"Name\":\"approve_guid\",\"Type\":\"string\"},{\"Name\":\"approved_by_admin\",\"Type\":\"int\"},{\"Name\":\"last_lat\",\"Type\":\"string\"},{\"Name\":\"last_lng\",\"Type\":\"string\"},{\"Name\":\"last_location_date\",\"Type\":\"timestamp\"},{\"Name\":\"last_seen_date\",\"Type\":\"timestamp\"},{\"Name\":\"system_row\",\"Type\":\"int\"},{\"Name\":\"user_rate\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"login_type\",\"Type\":\"int\"},{\"Name\":\"company_name\",\"Type\":\"string\"},{\"Name\":\"last_used_client\",\"Type\":\"int\"},{\"Name\":\"sms_approved\",\"Type\":\"int\"},{\"Name\":\"sms_code\",\"Type\":\"int\"},{\"Name\":\"customer_type\",\"Type\":\"int\"},{\"Name\":\"company_id\",\"Type\":\"int\"},{\"Name\":\"last_timezone\",\"Type\":\"int\"},{\"Name\":\"last_ip_address\",\"Type\":\"string\"},{\"Name\":\"last_api_vers\",\"Type\":\"int\"},{\"Name\":\"sending_mails\",\"Type\":\"int\"},{\"Name\":\"log_access_key\",\"Type\":\"string\"},{\"Name\":\"log_access_enabled\",\"Type\":\"int\"},{\"Name\":\"last_timezone2\",\"Type\":\"int\"},{\"Name\":\"request_update\",\"Type\":\"int\"},{\"Name\":\"cell_prefix\",\"Type\":\"string\"},{\"Name\":\"client_type\",\"Type\":\"int\"},{\"Name\":\"zip_code\",\"Type\":\"string\"},{\"Name\":\"two_step_verf_type\",\"Type\":\"int\"},{\"Name\":\"sms_sent_date\",\"Type\":\"timestamp\"}]},{\"Columns\":[{\"Name\":\"id\",\"Type\":\"int\"},{\"Name\":\"dic_id\",\"Type\":\"int\"},{\"Name\":\"list_name\",\"Type\":\"string\"},{\"Name\":\"list_priority\",\"Type\":\"int\"},{\"Name\":\"options_id\",\"Type\":\"int\"},{\"Name\":\"options_text\",\"Type\":\"string\"},{\"Name\":\"enabled\",\"Type\":\"int\"},{\"Name\":\"list_id\",\"Type\":\"int\"},{\"Name\":\"rules_text\",\"Type\":\"string\"},{\"Name\":\"list_short\",\"Type\":\"string\"},{\"Name\":\"list_value\",\"Type\":\"string\"},{\"Name\":\"list_icon\",\"Type\":\"string\"},{\"Name\":\"list_vers\",\"Type\":\"int\"}]},{\"Columns\":[{\"Name\":\"Op\",\"Type\":\"string\"},{\"Name\":\"id\",\"Type\":\"int\"},{\"Name\":\"pack_id\",\"Type\":\"int\"},{\"Name\":\"sender_id\",\"Type\":\"int\"},{\"Name\":\"courier_id\",\"Type\":\"int\"},{\"Name\":\"paid_amount\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"is_paid\",\"Type\":\"int\"},{\"Name\":\"payout_id\",\"Type\":\"int\"},{\"Name\":\"tip_courier_profit\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"tip_owner_profit\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"tip_bank_fee\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"tip_tax_fee\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"tip_stripe_fee\",\"Type\":\"string\"},{\"Name\":\"pay_type\",\"Type\":\"int\"},{\"Name\":\"org_amount\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"pt_cmt\",\"Type\":\"string\"},{\"Name\":\"tip_stripe_id\",\"Type\":\"string\"},{\"Name\":\"tip_given_type\",\"Type\":\"int\"}]},{\"Columns\":[{\"Name\":\"Op\",\"Type\":\"string\"},{\"Name\":\"id\",\"Type\":\"int\"},{\"Name\":\"pack_id\",\"Type\":\"int\"},{\"Name\":\"route_to_text\",\"Type\":\"string\"},{\"Name\":\"route_to_lat\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"route_to_lng\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"route_desc\",\"Type\":\"string\"},{\"Name\":\"route_status\",\"Type\":\"int\"},{\"Name\":\"route_delivery_date\",\"Type\":\"timestamp\"},{\"Name\":\"route_distance\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"route_distance_time\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"rec_name\",\"Type\":\"string\"},{\"Name\":\"rec_phone\",\"Type\":\"string\"},{\"Name\":\"route_sms_code\",\"Type\":\"int\"},{\"Name\":\"sms_sent_date\",\"Type\":\"timestamp\"},{\"Name\":\"received_person_name\",\"Type\":\"string\"},{\"Name\":\"radius_distance\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"goto_status\",\"Type\":\"int\"},{\"Name\":\"route_qrcode\",\"Type\":\"int\"},{\"Name\":\"route_work_type\",\"Type\":\"int\"},{\"Name\":\"route_qrcode_data\",\"Type\":\"string\"},{\"Name\":\"route_check_qrcode\",\"Type\":\"int\"},{\"Name\":\"route_priority\",\"Type\":\"int\"},{\"Name\":\"route_return_id\",\"Type\":\"int\"},{\"Name\":\"route_dest_type\",\"Type\":\"int\"},{\"Name\":\"route_track\",\"Type\":\"string\"},{\"Name\":\"remote_id\",\"Type\":\"string\"},{\"Name\":\"rec_phone_prefix\",\"Type\":\"string\"},{\"Name\":\"route_ident\",\"Type\":\"string\"},{\"Name\":\"route_ident2\",\"Type\":\"string\"},{\"Name\":\"sign_reason_text\",\"Type\":\"string\"},{\"Name\":\"route_sign\",\"Type\":\"string\"},{\"Name\":\"route_to_apt\",\"Type\":\"string\"},{\"Name\":\"sign_reason_id\",\"Type\":\"int\"},{\"Name\":\"route_tip\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"security_code\",\"Type\":\"string\"},{\"Name\":\"security_code_added\",\"Type\":\"int\"},{\"Name\":\"route_code\",\"Type\":\"string\"}]},{\"Columns\":[{\"Name\":\"Op\",\"Type\":\"string\"},{\"Name\":\"id\",\"Type\":\"int\"},{\"Name\":\"operation_name\",\"Type\":\"string\"},{\"Name\":\"operation_date\",\"Type\":\"timestamp\"},{\"Name\":\"user_id1\",\"Type\":\"int\"},{\"Name\":\"user_id2\",\"Type\":\"int\"},{\"Name\":\"pack_status\",\"Type\":\"int\"},{\"Name\":\"pack_id\",\"Type\":\"int\"},{\"Name\":\"user2_lat\",\"Type\":\"string\"},{\"Name\":\"user2_lng\",\"Type\":\"string\"},{\"Name\":\"webhook_status\",\"Type\":\"int\"},{\"Name\":\"oh_route_id\",\"Type\":\"int\"},{\"Name\":\"reason_id\",\"Type\":\"int\"},{\"Name\":\"reason_text\",\"Type\":\"string\"}]},{\"Columns\":[{\"Name\":\"id\",\"Type\":\"int\"},{\"Name\":\"paid_id\",\"Type\":\"int\"},{\"Name\":\"user_id\",\"Type\":\"int\"},{\"Name\":\"payment_amount\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"payout_date\",\"Type\":\"timestamp\"},{\"Name\":\"is_paid\",\"Type\":\"int\"},{\"Name\":\"inserted_by\",\"Type\":\"int\"},{\"Name\":\"inserted_date\",\"Type\":\"string\"},{\"Name\":\"paid_date\",\"Type\":\"string\"},{\"Name\":\"owner_profit\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"insurance_profit\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"bank_com_fee\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"tax_fee\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"stripe_payout_fee\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"delivery_count\",\"Type\":\"int\"}]},{\"Columns\":[{\"Name\":\"id\",\"Type\":\"int\"},{\"Name\":\"payout_id\",\"Type\":\"int\"},{\"Name\":\"payment_module\",\"Type\":\"int\"},{\"Name\":\"payment_module_id\",\"Type\":\"int\"},{\"Name\":\"payment_amount\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"pack_id\",\"Type\":\"int\"},{\"Name\":\"owner_profit\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"insurance_profit\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"bank_com_fee\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"tax_fee\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"stripe_fee\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"uq_guid\",\"Type\":\"string\"},{\"Name\":\"order_sending_name\",\"Type\":\"string\"},{\"Name\":\"pm_id\",\"Type\":\"int\"}]},{\"Columns\":[{\"Name\":\"id\",\"Type\":\"int\"},{\"Name\":\"order_id\",\"Type\":\"int\"},{\"Name\":\"from_name\",\"Type\":\"string\"},{\"Name\":\"from_street\",\"Type\":\"string\"},{\"Name\":\"from_city\",\"Type\":\"string\"},{\"Name\":\"from_state\",\"Type\":\"string\"},{\"Name\":\"from_zip\",\"Type\":\"string\"},{\"Name\":\"from_country\",\"Type\":\"string\"},{\"Name\":\"from_email\",\"Type\":\"string\"},{\"Name\":\"from_phone\",\"Type\":\"string\"},{\"Name\":\"to_name\",\"Type\":\"string\"},{\"Name\":\"to_street\",\"Type\":\"string\"},{\"Name\":\"to_city\",\"Type\":\"string\"},{\"Name\":\"to_state\",\"Type\":\"string\"},{\"Name\":\"to_zip\",\"Type\":\"string\"},{\"Name\":\"to_country\",\"Type\":\"string\"},{\"Name\":\"to_phone\",\"Type\":\"string\"},{\"Name\":\"parcel_length\",\"Type\":\"string\"},{\"Name\":\"parcel_width\",\"Type\":\"string\"},{\"Name\":\"parcel_height\",\"Type\":\"string\"},{\"Name\":\"parcel_distance_unit\",\"Type\":\"string\"},{\"Name\":\"parcel_weight\",\"Type\":\"string\"},{\"Name\":\"parcel_mass_unit\",\"Type\":\"string\"},{\"Name\":\"object_id\",\"Type\":\"string\"},{\"Name\":\"rate_results\",\"Type\":\"string\"},{\"Name\":\"trans_results\",\"Type\":\"string\"},{\"Name\":\"price_results\",\"Type\":\"string\"},{\"Name\":\"pack_details\",\"Type\":\"string\"},{\"Name\":\"refund_results\",\"Type\":\"string\"},{\"Name\":\"label_fil_type\",\"Type\":\"string\"},{\"Name\":\"label_url\",\"Type\":\"string\"},{\"Name\":\"tracking_number\",\"Type\":\"string\"},{\"Name\":\"tracking_url_provider\",\"Type\":\"string\"},{\"Name\":\"error_messages\",\"Type\":\"string\"},{\"Name\":\"status_id\",\"Type\":\"string\"},{\"Name\":\"inserted_date\",\"Type\":\"timestamp\"},{\"Name\":\"inserted_by\",\"Type\":\"int\"},{\"Name\":\"amount\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"currency\",\"Type\":\"string\"},{\"Name\":\"created_user_id\",\"Type\":\"int\"},{\"Name\":\"created_user_pass\",\"Type\":\"int\"},{\"Name\":\"pay_guid\",\"Type\":\"string\"},{\"Name\":\"pack_price\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"total_price\",\"Type\":\"string\"},{\"Name\":\"email_sent_customer\",\"Type\":\"timestamp\"},{\"Name\":\"email_sent_customer_cnt\",\"Type\":\"int\"},{\"Name\":\"sender_user_id\",\"Type\":\"int\"},{\"Name\":\"from_street2\",\"Type\":\"string\"},{\"Name\":\"to_street2\",\"Type\":\"string\"},{\"Name\":\"shippo_token\",\"Type\":\"string\"},{\"Name\":\"parcel_template\",\"Type\":\"string\"},{\"Name\":\"shippo_source\",\"Type\":\"string\"},{\"Name\":\"trans_id\",\"Type\":\"string\"},{\"Name\":\"status_update_date\",\"Type\":\"timestamp\"},{\"Name\":\"to_lat\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"to_lng\",\"Type\":\"decimal(10,2)\"}]},{\"Columns\":[{\"Name\":\"Op\",\"Type\":\"string\"},{\"Name\":\"id\",\"Type\":\"int\"},{\"Name\":\"company_name\",\"Type\":\"string\"},{\"Name\":\"customer_overload\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"courier_overload\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"montly_payment\",\"Type\":\"int\"},{\"Name\":\"cc_payment\",\"Type\":\"int\"},{\"Name\":\"cp_is_enabled\",\"Type\":\"int\"},{\"Name\":\"cp_pack_limit\",\"Type\":\"int\"},{\"Name\":\"dedicate_type\",\"Type\":\"int\"},{\"Name\":\"cp_tariff_id\",\"Type\":\"int\"},{\"Name\":\"client_id\",\"Type\":\"string\"},{\"Name\":\"secret_id\",\"Type\":\"string\"},{\"Name\":\"cp_state_id\",\"Type\":\"int\"},{\"Name\":\"cp_stripe_id\",\"Type\":\"string\"},{\"Name\":\"cp_card_last_4\",\"Type\":\"string\"},{\"Name\":\"cp_send_user_email\",\"Type\":\"int\"},{\"Name\":\"cp_send_pack_email\",\"Type\":\"int\"},{\"Name\":\"cp_send_pack_nots\",\"Type\":\"int\"},{\"Name\":\"instant_not_url\",\"Type\":\"string\"},{\"Name\":\"instant_not_enabled\",\"Type\":\"int\"},{\"Name\":\"instant_not_approved\",\"Type\":\"int\"},{\"Name\":\"max_route_count\",\"Type\":\"int\"},{\"Name\":\"api_approved_by_admin\",\"Type\":\"int\"},{\"Name\":\"api_approved_by_owner\",\"Type\":\"int\"},{\"Name\":\"cp_email\",\"Type\":\"string\"},{\"Name\":\"route_customer_overload\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"route_courier_overload\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"google_api_key\",\"Type\":\"string\"},{\"Name\":\"company_pickup_text\",\"Type\":\"string\"},{\"Name\":\"company_pickup_lat\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"company_pickup_lng\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"email_api_enabled\",\"Type\":\"int\"},{\"Name\":\"email_api_reply_mode\",\"Type\":\"int\"},{\"Name\":\"balance_payment_enabled\",\"Type\":\"int\"},{\"Name\":\"bulk_order_enabled\",\"Type\":\"int\"},{\"Name\":\"cp_pack_mailing\",\"Type\":\"int\"},{\"Name\":\"single_drop_off_enabled\",\"Type\":\"int\"},{\"Name\":\"send_track_sms\",\"Type\":\"int\"},{\"Name\":\"tack_sms_text\",\"Type\":\"string\"},{\"Name\":\"webhooks_enabled\",\"Type\":\"int\"},{\"Name\":\"deliver_sms_text\",\"Type\":\"string\"},{\"Name\":\"alg_id\",\"Type\":\"int\"},{\"Name\":\"deliver_sms_text_pickup\",\"Type\":\"string\"},{\"Name\":\"cloud_access\",\"Type\":\"int\"},{\"Name\":\"senpex_access\",\"Type\":\"int\"},{\"Name\":\"company_ctype\",\"Type\":\"int\"},{\"Name\":\"pickup_sms_text\",\"Type\":\"string\"},{\"Name\":\"start_route_sms_text\",\"Type\":\"string\"},{\"Name\":\"api_timezone_mins\",\"Type\":\"int\"},{\"Name\":\"rep_default_driver_id\",\"Type\":\"int\"},{\"Name\":\"cp_parent_id\",\"Type\":\"int\"},{\"Name\":\"cp_allow_create_company\",\"Type\":\"int\"},{\"Name\":\"api_location_access\",\"Type\":\"int\"},{\"Name\":\"cp_planning_disabled\",\"Type\":\"int\"},{\"Name\":\"webhook_engine\",\"Type\":\"string\"},{\"Name\":\"extra_service_tariff_id\",\"Type\":\"int\"},{\"Name\":\"moving_tariff_id\",\"Type\":\"int\"},{\"Name\":\"tracking_enabled\",\"Type\":\"int\"},{\"Name\":\"tracking_engine\",\"Type\":\"string\"},{\"Name\":\"min_api_vers\",\"Type\":\"int\"},{\"Name\":\"cp_driver_controlling\",\"Type\":\"int\"},{\"Name\":\"auto_assign_mins\",\"Type\":\"int\"},{\"Name\":\"default_api_user_id\",\"Type\":\"int\"},{\"Name\":\"auth_bearer\",\"Type\":\"string\"},{\"Name\":\"price_model\",\"Type\":\"string\"}]}],\"SqlAliases\":[{\"Alias\":\"senpex_vers3_packages\",\"From\":\"node-1745353692233\"},{\"Alias\":\"senpex_vers3_pack_details\",\"From\":\"node-1745353732624\"},{\"Alias\":\"senpex_vers3_users\",\"From\":\"node-1745353733832\"},{\"Alias\":\"senpex_vers3_dic_list\",\"From\":\"node-1745353734481\"},{\"Alias\":\"senpex_vers3_pack_tips\",\"From\":\"node-1745353735176\"},{\"Alias\":\"senpex_vers3_pack_routes\",\"From\":\"node-1745353735984\"},{\"Alias\":\"senpex_vers3_operation_history\",\"From\":\"node-1745353927278\"},{\"Alias\":\"senpex_vers3_payouts\",\"From\":\"node-1745353928470\"},{\"Alias\":\"senpex_vers3_payout_details\",\"From\":\"node-1745353929774\"},{\"Alias\":\"senpex_vers3_shippo_list\",\"From\":\"node-1745353931638\"},{\"Alias\":\"senpex_vers3_companies\",\"From\":\"node-1745354071485\"}],\"SqlQuery\":\"SELECT \\n        t1.order_id AS order_id,\\n        (CASE\\n            WHEN\\n                ((o.courier_is_selected = 1)\\n                    AND (t1.pack_status = 100)\\n                    AND ((t1.accepted_courier_id IS NOT NULL)\\n                    OR (t1.inserted_date < '2024-01-01'))\\n                    AND (t1.pk_company_id = 50167))\\n            THEN\\n                CONCAT('OneRail Cancelled after courier selected',\\n                        t1.order_name)\\n            ELSE t1.order_name\\n        END) AS order_name,\\n        t1.stripe_id AS stripe_id,\\n        t1.inserted_date AS inserted_date,\\n        t1.description_text AS description_text,\\n        t1.sender_name AS sender_name,\\n        t1.sender_surname AS sender_surname,\\n        t1.route_count AS route_count,\\n        (CASE\\n            WHEN\\n                ((o.courier_is_selected = 1)\\n                    AND (t1.pack_status = 100)\\n                    AND ((t1.accepted_courier_id IS NOT NULL)\\n                    OR (t1.inserted_date < '2024-01-01'))\\n                    AND (t1.pk_company_id = 50167))\\n            THEN\\n                10\\n            ELSE t1.pack_price\\n        END) AS pack_price,\\n        t1.courier_profit AS courier_profit,\\n        t1.pack_status AS pack_status,\\n        t1.pickup_date AS pickup_date,\\n        t1.waiting_fee AS waiting_fee,\\n        t1.package_status AS package_status,\\n        t1.status_courier AS status_courier,\\n        t1.pack_owner_id AS pack_owner_id,\\n        t1.courier_name AS courier_name,\\n        t1.courier_surname AS courier_surname,\\n        t1.pk_company_id AS pk_company_id,\\n        t1.email AS email,\\n        t1.order_type AS order_type,\\n        t1.payment_method AS payment_method,\\n        t1.order_source AS order_source,\\n        t1.distance AS distance,\\n        t1.timezone AS timezone,\\n        t1.total_toll_fee AS total_toll_fee,\\n        t1.package_tip AS package_tip,\\n        (CASE\\n            WHEN (t1.sender_name = 'ezCater') THEN 'eZCater'\\n            WHEN (t1.email = 'tmasamori@scu.edu') THEN 'dlgray@scu.edu'\\n            WHEN (t1.email = 'tiffany.leong@doordash.com') THEN 'DoorDash'\\n            ELSE COALESCE(c.company_name,\\n                    comp.company_name,\\n                    t1.email)\\n        END) AS company_name_id,\\n        (CASE\\n            WHEN t1.order_id = 143568 THEN timestampadd(minute, 1, timestamp('2022-08-31'))\\n        ELSE timestampadd(minute, t1.timezone, o.operation_date)\\n        END) AS delivery_date,\\n        o.distinct_route_count AS distinct_route_count,\\n        'US' AS country\\n    FROM\\n        ((((SELECT \\n            p.id AS order_id,\\n                p.send_name AS order_name,\\n                p.stripe_id AS stripe_id,\\n                (CASE\\n                    WHEN p.id = 143568 THEN timestampadd(minute, 1, timestamp('2022-08-31'))\\n\\t\\t\\t\\t\\tELSE timestampadd(minute, coalesce(pd.pk_timezone, u.last_timezone), p.inserted_date)\\n                END) AS inserted_date,\\n                p.desc_text AS description_text,\\n                u.name AS sender_name,\\n                u.surname AS sender_surname,\\n                pd.route_count AS route_count,\\n                (CASE\\n                    WHEN\\n                        ((p.send_name LIKE '%Sushi Delivery SF (2 location-morning)%')\\n                            AND (p.inserted_date < CAST('2022-07-04' AS DATE)))\\n                    THEN\\n                        ROUND((pd.route_count * 40.45), 2)\\n                    WHEN\\n                        (pd.pk_company_id = 50029)\\n                    THEN\\n                        (p.total_charge_price + (CASE\\n                            WHEN (COALESCE(pd.owner_waiting_amount, 0) <= 15) THEN 0\\n                            WHEN (pd.owner_waiting_amount <= 30) THEN 5\\n                            WHEN (pd.owner_waiting_amount <= 45) THEN 10\\n                            WHEN (pd.owner_waiting_amount <= 60) THEN 15\\n                            WHEN (pd.owner_waiting_amount > 60) THEN 20\\n                            ELSE 0\\n                        END))\\n                    ELSE p.total_charge_price\\n                END) AS pack_price,\\n                (CASE\\n                    WHEN\\n                        (p.inserted_date <= lp.last_payout)\\n                    THEN\\n                        (CASE\\n                            WHEN (p.pack_owner_id = 1619) THEN IFNULL(py.total_courier_fee, 0)\\n                            ELSE IFNULL(py.total_courier_flat_fee, 0)\\n                        END)\\n                    ELSE (IFNULL(pt.tip_courier_profit, 0) + p.courier_profit)\\n                END) AS courier_profit,\\n                p.pack_status AS pack_status,\\n                p.taken_time AS pickup_date,\\n                pd.owner_waiting_amount AS waiting_fee,\\n                (CASE\\n                    WHEN (s.list_name = 'Completed') THEN 'Item is delivered'\\n                    ELSE s.list_name\\n                END) AS package_status,\\n                'status_courier' AS status_courier,\\n                p.pack_owner_id AS pack_owner_id,\\n                u2.name AS courier_name,\\n                u2.surname AS courier_surname,\\n                pd.pk_company_id AS pk_company_id,\\n                u.email AS email,\\n                (CASE\\n                    WHEN (p.order_type = 1) THEN 'In House Logistics'\\n                    WHEN (pd.pack_cr_client = '-500') THEN 'APPLE'\\n                    WHEN (pd.pack_cr_client = '-600') THEN 'ANDROID'\\n                    WHEN (pd.pack_cr_client = '-400') THEN 'WEB'\\n                    WHEN (pd.pack_cr_client = '-300') THEN 'API'\\n                    WHEN (pd.pack_cr_client = '-200') THEN 'API'\\n                    ELSE 'none'\\n                END) AS order_type,\\n                d.list_name AS payment_method,\\n                (CASE\\n                    WHEN (sl.order_id IS NOT NULL) THEN 'Nationwide'\\n                    WHEN\\n                        ((p.service_price > 0)\\n                            AND (p.helper_count > 0))\\n                    THEN\\n                        'Extra service with helpers'\\n                    WHEN (p.service_price > 0) THEN 'Extra service'\\n                    WHEN (p.helper_count > 0) THEN 'Helper service'\\n                    WHEN (p.order_type = 1) THEN 'In House Logistics'\\n                    WHEN (1 = 1) THEN 'Last Mile delivery'\\n                    WHEN (pd.pack_cr_client = -(200)) THEN 'API orders'\\n                    WHEN\\n                        ((p.pk_payment_type = 3)\\n                            AND (IFNULL(u.company_id, 0) < 1)\\n                            AND (IFNULL(pd.pk_company_id, 0) = 0)\\n                            AND (NOT ((u.email LIKE '%jetrord%'))))\\n                    THEN\\n                        'App orders'\\n                    ELSE 'Company'\\n                END) AS order_source,\\n                p.distance AS distance,\\n                (CASE\\n                    WHEN\\n                        ((pd.pk_timezone > 0)\\n                            AND (u.last_timezone > 0))\\n                    THEN\\n                        -(IFNULL(pd.pk_timezone, u.last_timezone))\\n                    WHEN (pd.pk_timezone > 0) THEN u.last_timezone\\n                    ELSE IFNULL(pd.pk_timezone, u.last_timezone)\\n                END) AS timezone,\\n                COALESCE(pd.ownwer_toll_amount) AS total_toll_fee,\\n                pd.pack_tip AS package_tip,\\n                p.accepted_courier_id AS accepted_courier_id\\n        FROM\\n            (((((((((senpex_vers3_packages p\\n        LEFT JOIN senpex_vers3_pack_details pd ON ((p.id = pd.pack_id)))\\n        LEFT JOIN senpex_vers3_shippo_list sl ON ((p.id = sl.order_id)))\\n        LEFT JOIN senpex_vers3_users u ON ((u.id = p.pack_owner_id)))\\n        LEFT JOIN senpex_vers3_users u2 ON ((u2.id = p.accepted_courier_id)))\\n        LEFT JOIN senpex_vers3_dic_list d ON (((p.pk_payment_type = d.list_id)\\n            AND (d.dic_id = 23))))\\n        LEFT JOIN senpex_vers3_dic_list s ON (((p.pack_status = s.list_id)\\n            AND (s.dic_id = 19))))\\n        LEFT JOIN (SELECT \\n            pd.pack_id AS pack_id,\\n                SUM((CASE\\n                    WHEN (pd.payment_module = 1) THEN pd.payment_amount\\n                    ELSE 0\\n                END)) AS total_courier_flat_fee,\\n                SUM((CASE\\n                    WHEN (pd.payment_module = 3) THEN pd.payment_amount\\n                    ELSE 0\\n                END)) AS total_courier_tip,\\n                SUM(pd.payment_amount) AS total_courier_fee\\n        FROM\\n            senpex_vers3_payout_details pd\\n        GROUP BY pd.pack_id) py ON ((py.pack_id = p.id)))\\n        LEFT JOIN (SELECT \\n            MAX(senpex_vers3_payouts.payout_date) AS last_payout\\n        FROM\\n            senpex_vers3_payouts) lp ON ((1 = 1)))\\n        LEFT JOIN senpex_vers3_pack_tips pt ON ((pt.pack_id = p.id)))) t1\\n        LEFT JOIN senpex_vers3_companies c ON ((t1.pk_company_id = c.id)))\\n        LEFT JOIN (SELECT \\n            u.email AS email,\\n                MAX(COALESCE(c.company_name, u.company_name)) AS company_name\\n        FROM\\n            (senpex_vers3_users u\\n        LEFT JOIN senpex_vers3_companies c ON ((u.company_id = c.id)))\\n        WHERE\\n            ((u.company_id <> 0)\\n                AND (LENGTH(COALESCE(c.company_name, u.company_name)) > 2)\\n                AND (u.email NOT IN ('ricks@senpex.com' , 'rick@senpex.com')))\\n        GROUP BY u.email) comp ON ((comp.email = t1.email)))\\n        LEFT JOIN (SELECT \\n            o.pack_id AS pack_id,\\n                MAX((CASE\\n                    WHEN (o.pack_status = 40) THEN o.operation_date\\n                    ELSE NULL\\n                END)) AS operation_date,\\n                COUNT(DISTINCT CONCAT(pr.route_to_lat, pr.route_to_lng, pr.route_to_text, TRIM(SUBSTR(pr.rec_name, (LOCATE(' ', pr.rec_name) + 1), 40)))) AS distinct_route_count,\\n                MAX((CASE\\n                    WHEN (o.operation_name = 'Courier selected') THEN 1\\n                    ELSE 0\\n                END)) AS courier_is_selected\\n        FROM\\n            (senpex_vers3_operation_history o\\n        LEFT JOIN senpex_vers3_pack_routes pr ON ((pr.pack_id = o.pack_id)))\\n        GROUP BY o.pack_id) o ON ((o.pack_id = t1.order_id)))\"}},\"node-1745356403593\":{\"S3ParquetSource\":{\"AdditionalOptions\":{\"EnableSamplePath\":false,\"SamplePath\":\"s3://senpex-cdc-iceberg/collectors/shops/LOAD00000001.parquet\"},\"Exclusions\":[],\"Name\":\"collectors_shops\",\"OutputSchemas\":[{\"Columns\":[{\"Name\":\"id\",\"Type\":\"int\"},{\"Name\":\"shop_name\",\"Type\":\"string\"},{\"Name\":\"shop_desc\",\"Type\":\"string\"},{\"Name\":\"shop_address\",\"Type\":\"string\"},{\"Name\":\"shop_lat\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"shop_lng\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"shop_cell\",\"Type\":\"string\"},{\"Name\":\"inserted_by\",\"Type\":\"int\"},{\"Name\":\"inserted_date\",\"Type\":\"string\"},{\"Name\":\"shop_timezone\",\"Type\":\"int\"},{\"Name\":\"remote_access_key\",\"Type\":\"string\"}]}],\"Paths\":[\"s3://senpex-cdc-iceberg/collectors/shops/\"],\"Recurse\":true}},\"node-1745353927278\":{\"S3ParquetSource\":{\"AdditionalOptions\":{\"EnableSamplePath\":false,\"SamplePath\":\"s3://senpex-cdc-iceberg/senpex_vers3/operation_history/20250411-002112093.parquet\"},\"Exclusions\":[],\"Name\":\"senpex_vers3_operation_history\",\"OutputSchemas\":[{\"Columns\":[{\"Name\":\"Op\",\"Type\":\"string\"},{\"Name\":\"id\",\"Type\":\"int\"},{\"Name\":\"operation_name\",\"Type\":\"string\"},{\"Name\":\"operation_date\",\"Type\":\"timestamp\"},{\"Name\":\"user_id1\",\"Type\":\"int\"},{\"Name\":\"user_id2\",\"Type\":\"int\"},{\"Name\":\"pack_status\",\"Type\":\"int\"},{\"Name\":\"pack_id\",\"Type\":\"int\"},{\"Name\":\"user2_lat\",\"Type\":\"string\"},{\"Name\":\"user2_lng\",\"Type\":\"string\"},{\"Name\":\"webhook_status\",\"Type\":\"int\"},{\"Name\":\"oh_route_id\",\"Type\":\"int\"},{\"Name\":\"reason_id\",\"Type\":\"int\"},{\"Name\":\"reason_text\",\"Type\":\"string\"}]}],\"Paths\":[\"s3://senpex-cdc-iceberg/senpex_vers3/operation_history/\"],\"Recurse\":true}},\"node-1745354071485\":{\"S3ParquetSource\":{\"AdditionalOptions\":{\"EnableSamplePath\":false,\"SamplePath\":\"s3://senpex-cdc-iceberg/senpex_vers3/companies/20250414-180046647.parquet\"},\"Exclusions\":[],\"Name\":\"senpex_vers3_companies\",\"OutputSchemas\":[{\"Columns\":[{\"Name\":\"Op\",\"Type\":\"string\"},{\"Name\":\"id\",\"Type\":\"int\"},{\"Name\":\"company_name\",\"Type\":\"string\"},{\"Name\":\"customer_overload\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"courier_overload\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"montly_payment\",\"Type\":\"int\"},{\"Name\":\"cc_payment\",\"Type\":\"int\"},{\"Name\":\"cp_is_enabled\",\"Type\":\"int\"},{\"Name\":\"cp_pack_limit\",\"Type\":\"int\"},{\"Name\":\"dedicate_type\",\"Type\":\"int\"},{\"Name\":\"cp_tariff_id\",\"Type\":\"int\"},{\"Name\":\"client_id\",\"Type\":\"string\"},{\"Name\":\"secret_id\",\"Type\":\"string\"},{\"Name\":\"cp_state_id\",\"Type\":\"int\"},{\"Name\":\"cp_stripe_id\",\"Type\":\"string\"},{\"Name\":\"cp_card_last_4\",\"Type\":\"string\"},{\"Name\":\"cp_send_user_email\",\"Type\":\"int\"},{\"Name\":\"cp_send_pack_email\",\"Type\":\"int\"},{\"Name\":\"cp_send_pack_nots\",\"Type\":\"int\"},{\"Name\":\"instant_not_url\",\"Type\":\"string\"},{\"Name\":\"instant_not_enabled\",\"Type\":\"int\"},{\"Name\":\"instant_not_approved\",\"Type\":\"int\"},{\"Name\":\"max_route_count\",\"Type\":\"int\"},{\"Name\":\"api_approved_by_admin\",\"Type\":\"int\"},{\"Name\":\"api_approved_by_owner\",\"Type\":\"int\"},{\"Name\":\"cp_email\",\"Type\":\"string\"},{\"Name\":\"route_customer_overload\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"route_courier_overload\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"google_api_key\",\"Type\":\"string\"},{\"Name\":\"company_pickup_text\",\"Type\":\"string\"},{\"Name\":\"company_pickup_lat\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"company_pickup_lng\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"email_api_enabled\",\"Type\":\"int\"},{\"Name\":\"email_api_reply_mode\",\"Type\":\"int\"},{\"Name\":\"balance_payment_enabled\",\"Type\":\"int\"},{\"Name\":\"bulk_order_enabled\",\"Type\":\"int\"},{\"Name\":\"cp_pack_mailing\",\"Type\":\"int\"},{\"Name\":\"single_drop_off_enabled\",\"Type\":\"int\"},{\"Name\":\"send_track_sms\",\"Type\":\"int\"},{\"Name\":\"tack_sms_text\",\"Type\":\"string\"},{\"Name\":\"webhooks_enabled\",\"Type\":\"int\"},{\"Name\":\"deliver_sms_text\",\"Type\":\"string\"},{\"Name\":\"alg_id\",\"Type\":\"int\"},{\"Name\":\"deliver_sms_text_pickup\",\"Type\":\"string\"},{\"Name\":\"cloud_access\",\"Type\":\"int\"},{\"Name\":\"senpex_access\",\"Type\":\"int\"},{\"Name\":\"company_ctype\",\"Type\":\"int\"},{\"Name\":\"pickup_sms_text\",\"Type\":\"string\"},{\"Name\":\"start_route_sms_text\",\"Type\":\"string\"},{\"Name\":\"api_timezone_mins\",\"Type\":\"int\"},{\"Name\":\"rep_default_driver_id\",\"Type\":\"int\"},{\"Name\":\"cp_parent_id\",\"Type\":\"int\"},{\"Name\":\"cp_allow_create_company\",\"Type\":\"int\"},{\"Name\":\"api_location_access\",\"Type\":\"int\"},{\"Name\":\"cp_planning_disabled\",\"Type\":\"int\"},{\"Name\":\"webhook_engine\",\"Type\":\"string\"},{\"Name\":\"extra_service_tariff_id\",\"Type\":\"int\"},{\"Name\":\"moving_tariff_id\",\"Type\":\"int\"},{\"Name\":\"tracking_enabled\",\"Type\":\"int\"},{\"Name\":\"tracking_engine\",\"Type\":\"string\"},{\"Name\":\"min_api_vers\",\"Type\":\"int\"},{\"Name\":\"cp_driver_controlling\",\"Type\":\"int\"},{\"Name\":\"auto_assign_mins\",\"Type\":\"int\"},{\"Name\":\"default_api_user_id\",\"Type\":\"int\"},{\"Name\":\"auth_bearer\",\"Type\":\"string\"},{\"Name\":\"price_model\",\"Type\":\"string\"}]}],\"Paths\":[\"s3://senpex-cdc-iceberg/senpex_vers3/companies/\"],\"Recurse\":true}},\"node-1745353733832\":{\"S3ParquetSource\":{\"AdditionalOptions\":{\"EnableSamplePath\":false,\"SamplePath\":\"s3://senpex-cdc-iceberg/senpex_vers3/users/20250411-001910530.parquet\"},\"Exclusions\":[],\"Name\":\"senpex_vers3_users\",\"OutputSchemas\":[{\"Columns\":[{\"Name\":\"Op\",\"Type\":\"string\"},{\"Name\":\"id\",\"Type\":\"int\"},{\"Name\":\"name\",\"Type\":\"string\"},{\"Name\":\"surname\",\"Type\":\"string\"},{\"Name\":\"cell\",\"Type\":\"string\"},{\"Name\":\"email\",\"Type\":\"string\"},{\"Name\":\"password\",\"Type\":\"string\"},{\"Name\":\"city\",\"Type\":\"string\"},{\"Name\":\"address_actual\",\"Type\":\"string\"},{\"Name\":\"address_offical\",\"Type\":\"string\"},{\"Name\":\"country\",\"Type\":\"string\"},{\"Name\":\"use_location\",\"Type\":\"int\"},{\"Name\":\"use_offical\",\"Type\":\"int\"},{\"Name\":\"gender\",\"Type\":\"int\"},{\"Name\":\"paypal_email\",\"Type\":\"string\"},{\"Name\":\"inserted_by\",\"Type\":\"int\"},{\"Name\":\"inserted_date\",\"Type\":\"timestamp\"},{\"Name\":\"updated_by\",\"Type\":\"int\"},{\"Name\":\"updated_date\",\"Type\":\"timestamp\"},{\"Name\":\"merital_status\",\"Type\":\"int\"},{\"Name\":\"referal_name\",\"Type\":\"string\"},{\"Name\":\"referal_cell\",\"Type\":\"string\"},{\"Name\":\"idcard_img1\",\"Type\":\"string\"},{\"Name\":\"idcard_img2\",\"Type\":\"string\"},{\"Name\":\"idcard_number\",\"Type\":\"string\"},{\"Name\":\"idcard_exp_date\",\"Type\":\"date\"},{\"Name\":\"idcatd_state\",\"Type\":\"string\"},{\"Name\":\"ssn_number\",\"Type\":\"string\"},{\"Name\":\"self_img\",\"Type\":\"string\"},{\"Name\":\"qst_health\",\"Type\":\"int\"},{\"Name\":\"qst_disability\",\"Type\":\"int\"},{\"Name\":\"qst_criminal\",\"Type\":\"int\"},{\"Name\":\"qst_sexsual\",\"Type\":\"int\"},{\"Name\":\"is_approved\",\"Type\":\"int\"},{\"Name\":\"avail_status\",\"Type\":\"int\"},{\"Name\":\"log_session_key\",\"Type\":\"string\"},{\"Name\":\"log_device_id\",\"Type\":\"string\"},{\"Name\":\"log_user_argent\",\"Type\":\"string\"},{\"Name\":\"log_date\",\"Type\":\"timestamp\"},{\"Name\":\"is_disabled\",\"Type\":\"int\"},{\"Name\":\"approve_guid\",\"Type\":\"string\"},{\"Name\":\"approved_by_admin\",\"Type\":\"int\"},{\"Name\":\"last_lat\",\"Type\":\"string\"},{\"Name\":\"last_lng\",\"Type\":\"string\"},{\"Name\":\"last_location_date\",\"Type\":\"timestamp\"},{\"Name\":\"last_seen_date\",\"Type\":\"timestamp\"},{\"Name\":\"system_row\",\"Type\":\"int\"},{\"Name\":\"user_rate\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"login_type\",\"Type\":\"int\"},{\"Name\":\"company_name\",\"Type\":\"string\"},{\"Name\":\"last_used_client\",\"Type\":\"int\"},{\"Name\":\"sms_approved\",\"Type\":\"int\"},{\"Name\":\"sms_code\",\"Type\":\"int\"},{\"Name\":\"customer_type\",\"Type\":\"int\"},{\"Name\":\"company_id\",\"Type\":\"int\"},{\"Name\":\"last_timezone\",\"Type\":\"int\"},{\"Name\":\"last_ip_address\",\"Type\":\"string\"},{\"Name\":\"last_api_vers\",\"Type\":\"int\"},{\"Name\":\"sending_mails\",\"Type\":\"int\"},{\"Name\":\"log_access_key\",\"Type\":\"string\"},{\"Name\":\"log_access_enabled\",\"Type\":\"int\"},{\"Name\":\"last_timezone2\",\"Type\":\"int\"},{\"Name\":\"request_update\",\"Type\":\"int\"},{\"Name\":\"cell_prefix\",\"Type\":\"string\"},{\"Name\":\"client_type\",\"Type\":\"int\"},{\"Name\":\"zip_code\",\"Type\":\"string\"},{\"Name\":\"two_step_verf_type\",\"Type\":\"int\"},{\"Name\":\"sms_sent_date\",\"Type\":\"timestamp\"}]}],\"Paths\":[\"s3://senpex-cdc-iceberg/senpex_vers3/users/\"],\"Recurse\":true}},\"node-1745356287122\":{\"S3ParquetSource\":{\"AdditionalOptions\":{\"EnableSamplePath\":false,\"SamplePath\":\"s3://senpex-cdc-iceberg/collectors/orders/20250422-171842549.parquet\"},\"Exclusions\":[],\"Name\":\"collectors_orders\",\"OutputSchemas\":[{\"Columns\":[{\"Name\":\"Op\",\"Type\":\"string\"},{\"Name\":\"id\",\"Type\":\"int\"},{\"Name\":\"order_name\",\"Type\":\"string\"},{\"Name\":\"member_id\",\"Type\":\"string\"},{\"Name\":\"customer\",\"Type\":\"string\"},{\"Name\":\"store\",\"Type\":\"string\"},{\"Name\":\"delivery_info\",\"Type\":\"string\"},{\"Name\":\"delivery_date\",\"Type\":\"timestamp\"},{\"Name\":\"delivery_time\",\"Type\":\"timestamp\"},{\"Name\":\"inserted_by\",\"Type\":\"int\"},{\"Name\":\"inserted_date\",\"Type\":\"string\"},{\"Name\":\"status_id\",\"Type\":\"int\"},{\"Name\":\"accepted_col_id\",\"Type\":\"int\"},{\"Name\":\"accepted_date\",\"Type\":\"string\"},{\"Name\":\"shop_id\",\"Type\":\"int\"},{\"Name\":\"start_date\",\"Type\":\"timestamp\"},{\"Name\":\"finish_date\",\"Type\":\"timestamp\"},{\"Name\":\"type_of_work\",\"Type\":\"int\"},{\"Name\":\"delivery_time2\",\"Type\":\"timestamp\"},{\"Name\":\"order_priority\",\"Type\":\"int\"},{\"Name\":\"estimated_time\",\"Type\":\"string\"},{\"Name\":\"drop_lat\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"drop_lng\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"qyt2\",\"Type\":\"int\"},{\"Name\":\"delivery_info_google\",\"Type\":\"string\"},{\"Name\":\"customer_cell\",\"Type\":\"string\"},{\"Name\":\"paid_status\",\"Type\":\"int\"},{\"Name\":\"senpex_order_id\",\"Type\":\"int\"},{\"Name\":\"distance\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"distance_time\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"pause\",\"Type\":\"int\"},{\"Name\":\"paused_mins\",\"Type\":\"int\"},{\"Name\":\"out_of_stock_items\",\"Type\":\"int\"}]}],\"Paths\":[\"s3://senpex-cdc-iceberg/collectors/orders/\"],\"Recurse\":true}},\"node-1745356503984\":{\"SparkSQL\":{\"Inputs\":[\"node-1745356287122\",\"node-1745356398241\",\"node-1745356403593\",\"node-1745353734481\",\"node-1745353692233\"],\"Name\":\"us_collection_service\",\"OutputSchemas\":[{\"Columns\":[{\"Name\":\"order_id\",\"Type\":\"bigint\"},{\"Name\":\"order_name\",\"Type\":\"string\"},{\"Name\":\"stripe_id\",\"Type\":\"null\"},{\"Name\":\"inserted_date\",\"Type\":\"timestamp\"},{\"Name\":\"collection_number\",\"Type\":\"string\"},{\"Name\":\"sender_name\",\"Type\":\"string\"},{\"Name\":\"sender_surname\",\"Type\":\"string\"},{\"Name\":\"route_count\",\"Type\":\"int\"},{\"Name\":\"pack_price\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"courier_profit\",\"Type\":\"null\"},{\"Name\":\"status_id\",\"Type\":\"int\"},{\"Name\":\"pickup_date\",\"Type\":\"timestamp\"},{\"Name\":\"waitin_fee\",\"Type\":\"null\"},{\"Name\":\"package_status\",\"Type\":\"string\"},{\"Name\":\"status_courier\",\"Type\":\"string\"},{\"Name\":\"pack_owner_id\",\"Type\":\"null\"},{\"Name\":\"courier_name\",\"Type\":\"null\"},{\"Name\":\"courier_surname\",\"Type\":\"null\"},{\"Name\":\"pk_company_id\",\"Type\":\"null\"},{\"Name\":\"email\",\"Type\":\"string\"},{\"Name\":\"order_type\",\"Type\":\"string\"},{\"Name\":\"payment_method\",\"Type\":\"string\"},{\"Name\":\"order_source\",\"Type\":\"string\"},{\"Name\":\"distance\",\"Type\":\"null\"},{\"Name\":\"timezone\",\"Type\":\"int\"},{\"Name\":\"total_toll_fee\",\"Type\":\"int\"},{\"Name\":\"package_tip\",\"Type\":\"int\"},{\"Name\":\"company_name_id\",\"Type\":\"string\"},{\"Name\":\"delivery_date\",\"Type\":\"null\"},{\"Name\":\"distinct_route_count\",\"Type\":\"int\"},{\"Name\":\"country\",\"Type\":\"string\"}]}],\"SqlAliases\":[{\"Alias\":\"collectors_orders\",\"From\":\"node-1745356287122\"},{\"Alias\":\"collectors_order_details\",\"From\":\"node-1745356398241\"},{\"Alias\":\"collectors_shops\",\"From\":\"node-1745356403593\"},{\"Alias\":\"senpex_vers3_dic_list\",\"From\":\"node-1745353734481\"},{\"Alias\":\"senpex_vers3_packages\",\"From\":\"node-1745353692233\"}],\"SqlQuery\":\"SELECT \\n        CAST(CONCAT('1', LPAD(o.id, 10, '0')) AS BIGINT) AS order_id,\\n    o.order_name AS order_name,\\n    NULL AS stripe_id,\\n    timestampadd(minute, -420, o.inserted_date) AS inserted_date,\\n    TRIM(SUBSTRING(o.order_name, LOCATE('300', o.order_name), 15)) AS collection_number,\\n        (CASE\\n            WHEN (o.shop_id = 20) THEN 'Chris'\\n            WHEN (o.shop_id = 21) THEN 'Jonathan'\\n            ELSE 'Chris'\\n        END) AS sender_name,\\n        (CASE\\n            WHEN (o.shop_id = 20) THEN 'Loui'\\n            WHEN (o.shop_id = 21) THEN 'Martinez'\\n            ELSE 'Loui'\\n        END) AS sender_surname,\\n        1 AS route_count,\\n        pr.senpex_fee AS pack_price,\\n        NULL AS courier_profit,\\n        o.status_id AS status_id,\\n        timestampadd(minute, -420, o.delivery_time) AS pickup_date,\\n        NULL AS waitin_fee,\\n        (CASE\\n            WHEN (dl.list_name = 'Completed') THEN 'Item is delivered'\\n            ELSE dl.list_name\\n        END) AS package_status,\\n        'status_courier' AS status_courier,\\n        NULL AS pack_owner_id,\\n        NULL AS courier_name,\\n        NULL AS courier_surname,\\n        NULL AS pk_company_id,\\n        '@jetrord.com' AS email,\\n        'API' AS order_type,\\n        'Company balance payment' AS payment_method,\\n        'Last Mile delivery' AS order_source,\\n        NULL AS distance,\\n        -(420) AS timezone,\\n        0 AS total_toll_fee,\\n        0 AS package_tip,\\n        (CASE\\n            WHEN\\n                (o.shop_id IS NOT NULL)\\n            THEN\\n                REPLACE(s.shop_name,\\n                    'RD',\\n                    'Restaurant Depot')\\n            WHEN (LOWER(o.store) LIKE '%san jose%') THEN 'Restaurant Depot San Jose'\\n            WHEN (LOWER(o.store) LIKE '%oakland%') THEN 'Restaurant Depot Oakland'\\n            WHEN (LOWER(o.store) LIKE '%concord%') THEN 'Restaurant Depot Concord'\\n            ELSE 'Restaurant Depot'\\n        END) AS company_name_id,\\n        NULL AS delivery_date,\\n        1 AS distinct_route_count,\\n        'US' AS country\\n    FROM\\n        ((collectors_orders o\\n        LEFT JOIN collectors_shops s ON ((s.id = o.shop_id)))\\n        LEFT JOIN (SELECT \\n            ((SUM(CAST(REPLACE(TRIM(od.subtotal), '$', '') AS DECIMAL (10 , 2 ))) * (CASE\\n                    WHEN (o.type_of_work = 0) THEN 10\\n                    ELSE 4\\n                END)) / 100) AS senpex_fee,\\n                o.id AS details_id\\n        FROM\\n            (collectors_order_details od\\n        JOIN collectors_orders o ON ((o.id = od.order_id)))\\n        GROUP BY o.id, o.type_of_work) pr ON ((pr.details_id = o.id)))\\n        LEFT JOIN senpex_vers3_dic_list dl ON (((o.status_id = dl.list_id)\\n            AND (dl.dic_id = 19)))\\n         left join (SELECT DISTINCT\\n                (CASE\\n                        WHEN\\n                            (LENGTH(TRIM(SUBSTR(p.send_name,\\n                                            LOCATE('300', p.send_name),\\n                                            10))) > 5)\\n                        THEN\\n                            TRIM(SUBSTR(p.send_name,\\n                                    LOCATE('300', p.send_name),\\n                                    10))\\n                        WHEN\\n                            (LENGTH(TRIM(SUBSTR(p.send_name,\\n                                            LOCATE('0000', p.send_name),\\n                                            10))) > 5)\\n                        THEN\\n                            TRIM(SUBSTR(p.send_name,\\n                                    LOCATE('0000', p.send_name),\\n                                    10))\\n                        WHEN\\n                            (LENGTH(TRIM(SUBSTR(p.send_name,\\n                                            LOCATE('# 000', p.send_name),\\n                                            11))) > 5)\\n                        THEN\\n                            TRIM(SUBSTR(p.send_name,\\n                                    LOCATE('# 000', p.send_name),\\n                                    11))\\n                        WHEN\\n                            (LENGTH(TRIM(SUBSTR(p.send_name,\\n                                            LOCATE('000', p.send_name),\\n                                            10))) > 5)\\n                        THEN\\n                            TRIM(SUBSTR(p.send_name,\\n                                    LOCATE('000', p.send_name),\\n                                    10))\\n                        ELSE 1\\n                    END) AS order_num\\n            FROM\\n                senpex_vers3_packages p) pp  \\n\\t\\t\\ton pp.order_num =\\n                (CASE\\n            WHEN\\n                (LENGTH(TRIM(SUBSTR(o.order_name,\\n                                LOCATE('300', o.order_name),\\n                                10))) > 5)\\n            THEN\\n                TRIM(SUBSTR(o.order_name,\\n                        LOCATE('300', o.order_name),\\n                        10))\\n            WHEN\\n                (LENGTH(TRIM(SUBSTR(o.order_name,\\n                                LOCATE('0000', o.order_name),\\n                                10))) > 5)\\n            THEN\\n                TRIM(SUBSTR(o.order_name,\\n                        LOCATE('0000', o.order_name),\\n                        10))\\n            WHEN\\n                (LENGTH(TRIM(SUBSTR(o.order_name,\\n                                LOCATE('# 000', o.order_name),\\n                                11))) > 5)\\n            THEN\\n                TRIM(SUBSTR(o.order_name,\\n                        LOCATE('# 000', o.order_name),\\n                        11))\\n            WHEN\\n                (LENGTH(TRIM(SUBSTR(o.order_name,\\n                                LOCATE('000', o.order_name),\\n                                10))) > 5)\\n            THEN\\n                TRIM(SUBSTR(o.order_name,\\n                        LOCATE('000', o.order_name),\\n                        10))\\n            ELSE 11221212121254541\\n        END)\\n             WHERE\\n         pp.order_num is null\"}},\"node-1745353735984\":{\"S3ParquetSource\":{\"AdditionalOptions\":{\"EnableSamplePath\":false,\"SamplePath\":\"s3://senpex-cdc-iceberg/senpex_vers3/pack_routes/20250422-164602643.parquet\"},\"Exclusions\":[],\"Name\":\"senpex_vers3_pack_routes\",\"OutputSchemas\":[{\"Columns\":[{\"Name\":\"Op\",\"Type\":\"string\"},{\"Name\":\"id\",\"Type\":\"int\"},{\"Name\":\"pack_id\",\"Type\":\"int\"},{\"Name\":\"route_to_text\",\"Type\":\"string\"},{\"Name\":\"route_to_lat\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"route_to_lng\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"route_desc\",\"Type\":\"string\"},{\"Name\":\"route_status\",\"Type\":\"int\"},{\"Name\":\"route_delivery_date\",\"Type\":\"timestamp\"},{\"Name\":\"route_distance\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"route_distance_time\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"rec_name\",\"Type\":\"string\"},{\"Name\":\"rec_phone\",\"Type\":\"string\"},{\"Name\":\"route_sms_code\",\"Type\":\"int\"},{\"Name\":\"sms_sent_date\",\"Type\":\"timestamp\"},{\"Name\":\"received_person_name\",\"Type\":\"string\"},{\"Name\":\"radius_distance\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"goto_status\",\"Type\":\"int\"},{\"Name\":\"route_qrcode\",\"Type\":\"int\"},{\"Name\":\"route_work_type\",\"Type\":\"int\"},{\"Name\":\"route_qrcode_data\",\"Type\":\"string\"},{\"Name\":\"route_check_qrcode\",\"Type\":\"int\"},{\"Name\":\"route_priority\",\"Type\":\"int\"},{\"Name\":\"route_return_id\",\"Type\":\"int\"},{\"Name\":\"route_dest_type\",\"Type\":\"int\"},{\"Name\":\"route_track\",\"Type\":\"string\"},{\"Name\":\"remote_id\",\"Type\":\"string\"},{\"Name\":\"rec_phone_prefix\",\"Type\":\"string\"},{\"Name\":\"route_ident\",\"Type\":\"string\"},{\"Name\":\"route_ident2\",\"Type\":\"string\"},{\"Name\":\"sign_reason_text\",\"Type\":\"string\"},{\"Name\":\"route_sign\",\"Type\":\"string\"},{\"Name\":\"route_to_apt\",\"Type\":\"string\"},{\"Name\":\"sign_reason_id\",\"Type\":\"int\"},{\"Name\":\"route_tip\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"security_code\",\"Type\":\"string\"},{\"Name\":\"security_code_added\",\"Type\":\"int\"},{\"Name\":\"route_code\",\"Type\":\"string\"}]}],\"Paths\":[\"s3://senpex-cdc-iceberg/senpex_vers3/pack_routes/\"],\"Recurse\":true}},\"node-1745372950157\":{\"ApplyMapping\":{\"Inputs\":[\"node-1745372517781\"],\"Mapping\":[{\"Dropped\":false,\"FromPath\":[\"order_id\"],\"FromType\":\"bigint\",\"ToKey\":\"order_id\",\"ToType\":\"bigint\"},{\"Dropped\":false,\"FromPath\":[\"order_name\"],\"FromType\":\"string\",\"ToKey\":\"order_name\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"stripe_id\"],\"FromType\":\"null\",\"ToKey\":\"stripe_id\",\"ToType\":\"null\"},{\"Dropped\":false,\"FromPath\":[\"inserted_date\"],\"FromType\":\"timestamp\",\"ToKey\":\"inserted_date\",\"ToType\":\"timestamp\"},{\"Dropped\":false,\"FromPath\":[\"collection_number\"],\"FromType\":\"string\",\"ToKey\":\"collection_number\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"sender_name\"],\"FromType\":\"string\",\"ToKey\":\"sender_name\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"sender_surname\"],\"FromType\":\"string\",\"ToKey\":\"sender_surname\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"route_count\"],\"FromType\":\"int\",\"ToKey\":\"route_count\",\"ToType\":\"int\"},{\"Dropped\":false,\"FromPath\":[\"pack_price\"],\"FromType\":\"decimal\",\"ToKey\":\"pack_price\",\"ToType\":\"decimal\"},{\"Dropped\":false,\"FromPath\":[\"courier_profit\"],\"FromType\":\"null\",\"ToKey\":\"courier_profit\",\"ToType\":\"null\"},{\"Dropped\":false,\"FromPath\":[\"status_id\"],\"FromType\":\"int\",\"ToKey\":\"status_id\",\"ToType\":\"int\"},{\"Dropped\":false,\"FromPath\":[\"pickup_date\"],\"FromType\":\"timestamp\",\"ToKey\":\"pickup_date\",\"ToType\":\"timestamp\"},{\"Dropped\":false,\"FromPath\":[\"waitin_fee\"],\"FromType\":\"null\",\"ToKey\":\"waitin_fee\",\"ToType\":\"null\"},{\"Dropped\":false,\"FromPath\":[\"package_status\"],\"FromType\":\"string\",\"ToKey\":\"package_status\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"status_courier\"],\"FromType\":\"string\",\"ToKey\":\"status_courier\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"pack_owner_id\"],\"FromType\":\"null\",\"ToKey\":\"pack_owner_id\",\"ToType\":\"null\"},{\"Dropped\":false,\"FromPath\":[\"courier_name\"],\"FromType\":\"null\",\"ToKey\":\"courier_name\",\"ToType\":\"null\"},{\"Dropped\":false,\"FromPath\":[\"courier_surname\"],\"FromType\":\"null\",\"ToKey\":\"courier_surname\",\"ToType\":\"null\"},{\"Dropped\":false,\"FromPath\":[\"pk_company_id\"],\"FromType\":\"null\",\"ToKey\":\"pk_company_id\",\"ToType\":\"null\"},{\"Dropped\":false,\"FromPath\":[\"email\"],\"FromType\":\"string\",\"ToKey\":\"email\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"order_type\"],\"FromType\":\"string\",\"ToKey\":\"order_type\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"payment_method\"],\"FromType\":\"string\",\"ToKey\":\"payment_method\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"order_source\"],\"FromType\":\"string\",\"ToKey\":\"order_source\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"distance\"],\"FromType\":\"null\",\"ToKey\":\"distance\",\"ToType\":\"null\"},{\"Dropped\":false,\"FromPath\":[\"timezone\"],\"FromType\":\"int\",\"ToKey\":\"timezone\",\"ToType\":\"int\"},{\"Dropped\":false,\"FromPath\":[\"total_toll_fee\"],\"FromType\":\"int\",\"ToKey\":\"total_toll_fee\",\"ToType\":\"int\"},{\"Dropped\":false,\"FromPath\":[\"package_tip\"],\"FromType\":\"int\",\"ToKey\":\"package_tip\",\"ToType\":\"int\"},{\"Dropped\":false,\"FromPath\":[\"company_name_id\"],\"FromType\":\"string\",\"ToKey\":\"company_name_id\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"delivery_date\"],\"FromType\":\"null\",\"ToKey\":\"delivery_date\",\"ToType\":\"null\"},{\"Dropped\":false,\"FromPath\":[\"distinct_route_count\"],\"FromType\":\"int\",\"ToKey\":\"distinct_route_count\",\"ToType\":\"int\"},{\"Dropped\":false,\"FromPath\":[\"country\"],\"FromType\":\"string\",\"ToKey\":\"country\",\"ToType\":\"string\"}],\"Name\":\"Change Schema\"}}}",
  "sourceControlDetails" : {
    "provider" : "GITHUB",
    "repository" : "aws_all_transactions",
    "branch" : "main",
    "folder" : "all_transactions"
  }
}